<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>North Carolina SIDS data set (models) • spatialreg</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="North Carolina SIDS data set (models)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spatialreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a></li>
    <li><a class="dropdown-item" href="../articles/sids_models.html">North Carolina SIDS data set (models)</a></li>
    <li><a class="dropdown-item" href="../articles/SpatialFiltering.html">Moran Eigenvectors</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-spatial/spatialreg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>North Carolina SIDS data set (models)</h1>
                        <h4 data-toc-skip class="author">Roger
Bivand</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-spatial/spatialreg/blob/HEAD/vignettes/sids_models.Rmd" class="external-link"><code>vignettes/sids_models.Rmd</code></a></small>
      <div class="d-none name"><code>sids_models.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This data set was presented first in <span class="citation">Symons,
Grimson, and Yuan (<a href="#ref-symonsetal:1983">1983</a>)</span>,
analysed with reference to the spatial nature of the data in <span class="citation">Cressie and Read (<a href="#ref-cressie+read:1985">1985</a>)</span>, expanded in <span class="citation">Cressie and Chan (<a href="#ref-cressie+chan:1989">1989</a>)</span>, and used in detail in
<span class="citation">Cressie (<a href="#ref-cressie:1991">1991</a>)</span>. It is for the 100 counties of
North Carolina, and includes counts of numbers of live births (also
non-white live births) and numbers of sudden infant deaths, for the July
1, 1974 to June 30, 1978 and July 1, 1979 to June 30, 1984 periods. In
<span class="citation">Cressie and Read (<a href="#ref-cressie+read:1985">1985</a>)</span>, a listing of county
neighbours based on shared boundaries (contiguity) is given, and in
<span class="citation">Cressie and Chan (<a href="#ref-cressie+chan:1989">1989</a>)</span>, and in <span class="citation">Cressie (<a href="#ref-cressie:1991">1991,
386–89</a>)</span>, a different listing based on the criterion of
distance between county seats, with a cutoff at 30 miles. The county
seat location coordinates are given in miles in a local (unknown)
coordinate reference system. The data are also used to exemplify a range
of functions in the spatial statistics module user’s manual <span class="citation">(<a href="#ref-kaluznyetal:1996">Kaluzny et al.
1996</a>)</span>.</p>
</div>
<div class="section level2">
<h2 id="getting-the-data-into-r">Getting the data into R<a class="anchor" aria-label="anchor" href="#getting-the-data-into-r"></a>
</h2>
<p>We will be using the <strong>spdep</strong> and
<strong>spatialreg</strong> packages, here version: spdep, version
1.4-2, 2025-09-01, the <strong>sf</strong> package and the
<strong>tmap</strong> package. The data from the sources referred to
above is documented in the <a href="https://jakubnowosad.com/spData/reference/nc.sids.html" class="external-link">help
page</a> for the <code>nc.sids</code> data set in
<strong>spData</strong>. The actual data, included in a shapefile of the
county boundaries for North Carolina were made available in the
<strong>maptools</strong> package <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;These data were taken with permission from a now-offline
link: [sal.agecon.uiuc.edu/datasets/sids.zip]; see also &lt;a href="https://geodacenter.github.io/data-and-lab/" class="external-link"&gt;GeoDa Center&lt;/a&gt; for
a contemporary source.&lt;/p&gt;'><sup>1</sup></a>. These data are known to be geographical
coordinates (longitude-latitude in decimal degrees) and are assumed to
use the NAD27 datum.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/" class="external-link">spdep</a></span><span class="op">)</span></span>
<span><span class="va">nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"shapes/sids.gpkg"</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#st_crs(nc) &lt;- "+proj=longlat +datum=NAD27"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">nc</span><span class="op">$</span><span class="va">FIPSNO</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nc</span><span class="op">$</span><span class="va">ft.SID74</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">nc</span><span class="op">$</span><span class="va">SID74</span><span class="op">/</span><span class="va">nc</span><span class="op">$</span><span class="va">BIR74</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">nc</span><span class="op">$</span><span class="va">SID74</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="va">nc</span><span class="op">$</span><span class="va">BIR74</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nc</span><span class="op">$</span><span class="va">both</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">nc</span><span class="op">$</span><span class="va">L_id</span>, <span class="va">nc</span><span class="op">$</span><span class="va">M_id</span>, sep<span class="op">=</span><span class="st">":"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We will now examine the data set reproduced from Cressie and
collaborators, included in <strong>spData</strong> (formerly in
<strong>spdep</strong>), and add the neighbour relationships used in
<span class="citation">Cressie and Chan (<a href="#ref-cressie+chan:1989">1989</a>)</span> to the background map as
a graph shown in Figure :</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gal_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"weights/ncCC89.gal"</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">ncCC89</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/read.gal.html" class="external-link">read.gal</a></span><span class="op">(</span><span class="va">gal_file</span>, region.id<span class="op">=</span><span class="va">nc</span><span class="op">$</span><span class="va">FIPSNO</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="car-model-fitting">CAR model fitting<a class="anchor" aria-label="anchor" href="#car-model-fitting"></a>
</h3>
<p>We will now try to replicate three of the four models fitted by <span class="citation">(<a href="#ref-cressie+chan:1989">Cressie and Chan
1989</a>)</span> to the transformed rates variable. The first thing to
do is to try to replicate their 30 mile distance between county seats
neighbours, which almost works. From there we try to reconstruct three
of the four models they fit, concluding that we can get quite close, but
that a number of questions are raised along the way.</p>
<p>Building the weights is much more complicated, because they use a
combination of distance-metric and population-at-risk based weights, but
we can get quite close <span class="citation">(see also <a href="#ref-kaluznyetal:1996">Kaluzny et al. 1996</a>)</span>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sids.nhbr30.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nbdists.html" class="external-link">nbdists</a></span><span class="op">(</span><span class="va">ncCC89</span>, <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">nc</span><span class="op">$</span><span class="va">east</span>, <span class="va">nc</span><span class="op">$</span><span class="va">north</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sids.nhbr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/listw2sn.html" class="external-link">listw2sn</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">ncCC89</span>, glist<span class="op">=</span><span class="va">sids.nhbr30.dist</span>, style<span class="op">=</span><span class="st">"B"</span>, zero.policy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dij</span> <span class="op">&lt;-</span> <span class="va">sids.nhbr</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="va">nc</span><span class="op">$</span><span class="va">BIR74</span></span>
<span><span class="va">el1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">dij</span><span class="op">)</span><span class="op">/</span><span class="va">dij</span></span>
<span><span class="va">el2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">[</span><span class="va">sids.nhbr</span><span class="op">$</span><span class="va">to</span><span class="op">]</span><span class="op">/</span><span class="va">n</span><span class="op">[</span><span class="va">sids.nhbr</span><span class="op">$</span><span class="va">from</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sids.nhbr</span><span class="op">$</span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">el1</span><span class="op">*</span><span class="va">el2</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"spdep"</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="st">"1.3.1"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sids.nhbr.listw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/listw2sn.html" class="external-link">sn2listw</a></span><span class="op">(</span><span class="va">sids.nhbr</span>, style<span class="op">=</span><span class="st">"B"</span>, zero.policy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">sids.nhbr.listw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/listw2sn.html" class="external-link">sn2listw</a></span><span class="op">(</span><span class="va">sids.nhbr</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The first model (I) is a null model with just an intercept, the
second (II) includes all the 12 parcels of contiguous counties in 4
east-west and 4 north-south bands, while the fourth (IV) includes the
transformed non-white birth-rate:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nc</span><span class="op">$</span><span class="va">ft.NWBIR74</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">nc</span><span class="op">$</span><span class="va">NWBIR74</span><span class="op">/</span><span class="va">nc</span><span class="op">$</span><span class="va">BIR74</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">nc</span><span class="op">$</span><span class="va">NWBIR74</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="va">nc</span><span class="op">$</span><span class="va">BIR74</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Cressie identifies Anson county as an outlier, and drops it from
further analysis. Because the weights are constructed in a complicated
way, they will be subsetted by dropping the row and column of the
weights matrix:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm_nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">nc</span><span class="op">)</span></span>
<span><span class="va">outl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">rstandard</a></span><span class="op">(</span><span class="va">lm_nc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">nc</span><span class="op">$</span><span class="va">NAME</span><span class="op">[</span><span class="va">outl</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Anson"</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2mat.html" class="external-link">listw2mat</a></span><span class="op">(</span><span class="va">sids.nhbr.listw</span><span class="op">)</span></span>
<span><span class="va">W.4</span> <span class="op">&lt;-</span> <span class="va">W</span><span class="op">[</span><span class="op">-</span><span class="va">outl</span>, <span class="op">-</span><span class="va">outl</span><span class="op">]</span></span>
<span><span class="va">sids.nhbr.listw.4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/mat2listw.html" class="external-link">mat2listw</a></span><span class="op">(</span><span class="va">W.4</span><span class="op">)</span></span>
<span><span class="va">nc2</span> <span class="op">&lt;-</span> <span class="va">nc</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nc</span><span class="op">$</span><span class="va">CNTY_ID</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">outl</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>It appears that both numerical issues (convergence in particular) and
uncertainties about the exact spatial weights matrix used make it
difficult to reproduce the results of <span class="citation">Cressie and
Chan (<a href="#ref-cressie+chan:1989">1989</a>)</span>, also given in
<span class="citation">Cressie (<a href="#ref-cressie:1991">1991</a>)</span>. We now try to replicate them
for the null weighted CAR model (Cressie has intercept 2.838,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>θ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\theta}</annotation></semantics></math>
0.833, for k=1):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spatialreg/" class="external-link">spatialreg</a></span><span class="op">)</span></span>
<span><span class="va">ecarIaw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spautolm.html">spautolm</a></span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">nc2</span>, listw<span class="op">=</span><span class="va">sids.nhbr.listw.4</span>, weights<span class="op">=</span><span class="va">BIR74</span>, family<span class="op">=</span><span class="st">"CAR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ecarIaw</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call: spautolm(formula = ft.SID74 ~ 1, data = nc2, listw = sids.nhbr.listw.4, </span></span>
<span><span class="co">##     weights = BIR74, family = "CAR")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##       Min        1Q    Median        3Q       Max </span></span>
<span><span class="co">## -2.010292 -0.639658 -0.062209  0.443549  2.018065 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients: </span></span>
<span><span class="co">##             Estimate Std. Error z value  Pr(&gt;|z|)</span></span>
<span><span class="co">## (Intercept) 2.945323   0.095135  30.959 &lt; 2.2e-16</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Lambda: 0.86814 LR test value: 22.83 p-value: 1.7701e-06 </span></span>
<span><span class="co">## Numerical Hessian standard error of lambda: 0.04838 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Log likelihood: -118.8432 </span></span>
<span><span class="co">## ML residual variance (sigma squared): 1266.5, (sigma: 35.588)</span></span>
<span><span class="co">## Number of observations: 99 </span></span>
<span><span class="co">## Number of parameters estimated: 3 </span></span>
<span><span class="co">## AIC: NA (not available for weighted model)</span></span></code></pre>
<p>The spatial parcels model seems not to work, with Cressie’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>θ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\theta}</annotation></semantics></math>
0.710, and failure in the numerical Hessian used to calculate the
standard error of the spatial coefficient:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ecarIIaw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spautolm.html">spautolm</a></span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="va">both</span> <span class="op">-</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">nc2</span>, listw<span class="op">=</span><span class="va">sids.nhbr.listw.4</span>, weights<span class="op">=</span><span class="va">BIR74</span>, family<span class="op">=</span><span class="st">"CAR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ecarIIaw</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call: </span></span>
<span><span class="co">## spautolm(formula = ft.SID74 ~ both - 1, data = nc2, listw = sids.nhbr.listw.4, </span></span>
<span><span class="co">##     weights = BIR74, family = "CAR")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -2.55896 -0.46338 -0.02035  0.38935  2.05682 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients: </span></span>
<span><span class="co">##         Estimate Std. Error z value  Pr(&gt;|z|)</span></span>
<span><span class="co">## both1:2  2.06223    0.20016 10.3031 &lt; 2.2e-16</span></span>
<span><span class="co">## both1:3  2.91823    0.14139 20.6400 &lt; 2.2e-16</span></span>
<span><span class="co">## both1:4  4.11486    0.29939 13.7439 &lt; 2.2e-16</span></span>
<span><span class="co">## both2:1  2.57650    0.26905  9.5762 &lt; 2.2e-16</span></span>
<span><span class="co">## both2:2  2.17403    0.18222 11.9305 &lt; 2.2e-16</span></span>
<span><span class="co">## both2:3  2.67397    0.15329 17.4443 &lt; 2.2e-16</span></span>
<span><span class="co">## both2:4  3.11361    0.24699 12.6062 &lt; 2.2e-16</span></span>
<span><span class="co">## both3:1  2.94400    0.29893  9.8486 &lt; 2.2e-16</span></span>
<span><span class="co">## both3:2  2.65391    0.14098 18.8250 &lt; 2.2e-16</span></span>
<span><span class="co">## both3:3  2.91619    0.17099 17.0552 &lt; 2.2e-16</span></span>
<span><span class="co">## both3:4  3.20425    0.20349 15.7468 &lt; 2.2e-16</span></span>
<span><span class="co">## both4:3  3.80286    0.20806 18.2781 &lt; 2.2e-16</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Lambda: 0.2109 LR test value: 1.3088 p-value: 0.25261 </span></span>
<span><span class="co">## Numerical Hessian standard error of lambda: NaN </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Log likelihood: -99.25505 </span></span>
<span><span class="co">## ML residual variance (sigma squared): 891.48, (sigma: 29.858)</span></span>
<span><span class="co">## Number of observations: 99 </span></span>
<span><span class="co">## Number of parameters estimated: 14 </span></span>
<span><span class="co">## AIC: NA (not available for weighted model)</span></span></code></pre>
<p>Finally, the non-white model repeats Cressie’s finding that much of
the variance of the transformed SIDS rate for 1974–8 can be accounted
for by the transformed non-white birth variable (Cressie intercept
1.644,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>b</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{b}</annotation></semantics></math>
0.0346,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>θ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\theta}</annotation></semantics></math>
0.640 — not significant), but the estimate of the spatial coefficient is
not close here:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ecarIVaw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spautolm.html">spautolm</a></span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="va">ft.NWBIR74</span>, data<span class="op">=</span><span class="va">nc2</span>, listw<span class="op">=</span><span class="va">sids.nhbr.listw.4</span>, weights<span class="op">=</span><span class="va">BIR74</span>, family<span class="op">=</span><span class="st">"CAR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ecarIVaw</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call: </span></span>
<span><span class="co">## spautolm(formula = ft.SID74 ~ ft.NWBIR74, data = nc2, listw = sids.nhbr.listw.4, </span></span>
<span><span class="co">##     weights = BIR74, family = "CAR")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -1.99056 -0.44858  0.15468  0.60623  1.95541 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients: </span></span>
<span><span class="co">##              Estimate Std. Error z value  Pr(&gt;|z|)</span></span>
<span><span class="co">## (Intercept) 1.4371519  0.2252729  6.3796 1.775e-10</span></span>
<span><span class="co">## ft.NWBIR74  0.0408354  0.0062919  6.4902 8.572e-11</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Lambda: 0.22391 LR test value: 1.1577 p-value: 0.28194 </span></span>
<span><span class="co">## Numerical Hessian standard error of lambda: 0.55663 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Log likelihood: -114.0376 </span></span>
<span><span class="co">## ML residual variance (sigma squared): 1201.5, (sigma: 34.663)</span></span>
<span><span class="co">## Number of observations: 99 </span></span>
<span><span class="co">## Number of parameters estimated: 4 </span></span>
<span><span class="co">## AIC: NA (not available for weighted model)</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nc2</span><span class="op">$</span><span class="va">fitIV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted.values</a></span><span class="op">(</span><span class="va">ecarIVaw</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">tmap4</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">nc2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">tm_polygons</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"fitIV"</span>, fill.scale<span class="op">=</span><span class="fu">tm_scale</span><span class="op">(</span>values<span class="op">=</span><span class="st">"brewer.yl_or_br"</span><span class="op">)</span>, fill.legend<span class="op">=</span><span class="fu">tm_legend</span><span class="op">(</span>position<span class="op">=</span><span class="fu">tm_pos_in</span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"bottom"</span><span class="op">)</span>, frame<span class="op">=</span><span class="cn">FALSE</span>, item.r <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">nc2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">tm_fill</span><span class="op">(</span><span class="st">"fitIV"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="sids_models_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>The final figure shows the value of the log likelihood function for
the null model (I):</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ecarIawll</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spautolm.html">spautolm</a></span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">nc2</span>, listw<span class="op">=</span><span class="va">sids.nhbr.listw.4</span>, weights<span class="op">=</span><span class="va">BIR74</span>, family<span class="op">=</span><span class="st">"CAR"</span>, llprof<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.9020532358</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ll</span> <span class="op">~</span> <span class="va">lambda</span>, <span class="va">ecarIawll</span><span class="op">$</span><span class="va">llprof</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sids_models_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-cressie:1991" class="csl-entry">
Cressie, N. 1991. <em>Statistics for Spatial Data</em>. New York: Wiley.
</div>
<div id="ref-cressie+chan:1989" class="csl-entry">
Cressie, N., and N. H. Chan. 1989. <span>“Spatial Modelling of Regional
Variables.”</span> <em>Journal of the American Statistical
Association</em> 84: 393–401.
</div>
<div id="ref-cressie+read:1985" class="csl-entry">
Cressie, N., and T. R. C. Read. 1985. <span>“Do Sudden Infant Deaths
Come in Clusters?”</span> <em>Statistics and Decisions</em> Supplement
Issue 2: 333–49.
</div>
<div id="ref-kaluznyetal:1996" class="csl-entry">
Kaluzny, S. P., S. C. Vega, T. P. Cardoso, and A. A. Shelly. 1996.
<em><span>S-PLUS SPATIALSTATS</span> User’s Manual Version 1.0</em>.
Seattle: MathSoft Inc.
</div>
<div id="ref-symonsetal:1983" class="csl-entry">
Symons, M. J., R. C. Grimson, and Y. C. Yuan. 1983. <span>“Clustering of
Rare Events.”</span> <em>Biometrics</em> 39: 193–205.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Roger Bivand, Gianfranco Piras.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
