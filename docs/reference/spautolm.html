<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Spatial conditional and simultaneous autoregression model estimation — spautolm • spatialreg</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial conditional and simultaneous autoregression model estimation — spautolm"><meta property="og:description" content="Function taking family and weights arguments for spatial autoregression model estimation by Maximum Likelihood, using dense matrix methods, not suited to large data sets with thousands of observations. With one of the sparse matrix methods, larger numbers of observations can be handled, but the interval= argument should be set. The implementation is GLS using the single spatial coefficient value, here termed lambda, found by line search using optimize to maximise the log likelihood."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spatialreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3-3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a>
    </li>
    <li>
      <a href="../articles/sids_models.html">North Carolina SIDS data set (models)</a>
    </li>
    <li>
      <a href="../articles/SpatialFiltering.html">Moran Eigenvectors</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/r-spatial/spatialreg/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial conditional and simultaneous autoregression model estimation</h1>
    
    <div class="hidden name"><code>spautolm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function taking family and weights arguments for spatial autoregression model estimation by Maximum Likelihood, using dense matrix methods, not suited to large data sets with thousands of observations. With one of the sparse matrix methods, larger numbers of observations can be handled, but the <code>interval=</code> argument should be set. The implementation is GLS using the single spatial coefficient value, here termed lambda, found by line search using <code>optimize</code> to maximise the log likelihood.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spautolm</span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">listw</span>, <span class="va">weights</span>,</span>
<span> <span class="va">na.action</span>, family <span class="op">=</span> <span class="st">"SAR"</span>, method<span class="op">=</span><span class="st">"eigen"</span>, verbose <span class="op">=</span> <span class="cn">NULL</span>, trs<span class="op">=</span><span class="cn">NULL</span>,</span>
<span> interval<span class="op">=</span><span class="cn">NULL</span>, zero.policy <span class="op">=</span> <span class="cn">NULL</span>, tol.solve<span class="op">=</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>,</span>
<span> llprof<span class="op">=</span><span class="cn">NULL</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># S3 method for Spautolm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, correlation <span class="op">=</span> <span class="cn">FALSE</span>, adj.se<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span> Nagelkerke<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>a symbolic description of the model to be fit. The details 
of model specification are given for <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code></p></dd>

  <dt>data</dt>
<dd><p>an optional data frame containing the variables in the model. 
By default the variables are taken from the environment which the function 
is called.</p></dd>

  <dt>listw</dt>
<dd><p>a <code>listw</code> object created for example by <code>nb2listw</code></p></dd>

  <dt>weights</dt>
<dd><p>an optional vector of weights to be used in the fitting process</p></dd>

  <dt>na.action</dt>
<dd><p>a function (default <code>options("na.action")</code>), can also be <code>na.omit</code> or <code>na.exclude</code> with consequences for residuals and fitted values - in these cases the weights list will be subsetted to remove NAs in the data. Note that only weights lists created without using the glist argument to <code>nb2listw</code> may be subsetted.</p></dd>

  <dt>family</dt>
<dd><p>character string: either <code>"SAR"</code> or <code>"CAR"</code> for simultaneous or conditional autoregressions; <code>"SMA"</code> for spatial moving average added thanks to Jielai Ma - <code>"SMA"</code> is only implemented for method=<code>"eigen"</code> because it necessarily involves dense matrices</p></dd>

  <dt>method</dt>
<dd><p>character string: default <code>"eigen"</code> for use of dense matrices, <code>"Matrix_J"</code> for sparse matrices (restricted to spatial weights symmetric or similar to symmetric) using methods in the Matrix package; “Matrix” provides updating Cholesky decomposition methods. Values of method may also include "LU", which provides an alternative sparse matrix decomposition approach, and the "Chebyshev" and Monte Carlo "MC" approximate log-determinant methods.</p></dd>

  <dt>verbose</dt>
<dd><p>default NULL, use global option value; if TRUE, reports function values during optimization.</p></dd>

  <dt>trs</dt>
<dd><p>default NULL, if given, a vector of powered spatial weights matrix traces output by <code>trW</code>; when given, used in some Jacobian methods</p></dd>

  <dt>interval</dt>
<dd><p>search interval for autoregressive parameter when not using method="eigen"; default is c(-1,0.999), <code>optimize</code> will reset NA/NaN to a bound and gives a warning when the interval is poorly set; method="Matrix" will attempt to search for an appropriate interval, if find_interval=TRUE (fails on some platforms)</p></dd>

  <dt>zero.policy</dt>
<dd><p>default NULL, use global option value; Include list of no-neighbour observations in output if TRUE --- otherwise zero.policy is handled within the listw argument</p></dd>

  <dt>tol.solve</dt>
<dd><p>the tolerance for detecting linear dependencies in the columns of matrices to be inverted - passed to <code><a href="https://www.math.uzh.ch/pages/spam/reference/spam-solve.html" class="external-link">solve()</a></code> (default=double precision machine tolerance). Errors in <code><a href="https://www.math.uzh.ch/pages/spam/reference/spam-solve.html" class="external-link">solve()</a></code> may constitute indications of poorly scaled variables: if the variables have scales differing much from the autoregressive coefficient, the values in this matrix may be very different in scale, and inverting such a matrix is analytically possible by definition, but numerically unstable; rescaling the RHS variables alleviates this better than setting tol.solve to a very small value</p></dd>

  <dt>llprof</dt>
<dd><p>default NULL, can either be an integer, to divide the feasible range into llprof points, or a sequence of spatial coefficient values, at which to evaluate the likelihood function</p></dd>

 <dt>control</dt>
<dd><p>list of extra control arguments - see section below</p></dd>

  <dt>object</dt>
<dd><p><code>Spautolm</code> object from <code>spautolm</code></p></dd>

  <dt>correlation</dt>
<dd><p>logical; if 'TRUE', the correlation matrix of the estimated parameters is returned and printed (default=FALSE)</p></dd>

  <dt>adj.se</dt>
<dd><p>if TRUE, adjust the coefficient standard errors for the number of fitted coefficients</p></dd>

  <dt>Nagelkerke</dt>
<dd><p>if TRUE, the Nagelkerke pseudo R-squared is reported</p></dd>

  <dt>...</dt>
<dd><p>further arguments passed to or from other methods</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This implementation is based on <code><a href="https://rdrr.io/pkg/MASS/man/lm.gls.html" class="external-link">lm.gls</a></code> and <code><a href="ML_models.html">errorsarlm</a></code>. In particular, the function does not (yet) prevent asymmetric spatial weights being used with "CAR" family models. It appears that both numerical issues (convergence in particular) and uncertainties about the exact spatial weights matrix used make it difficult to reproduce Cressie and Chan's 1989 results, also given in Cressie 1993.</p>
<p>Note that the fitted() function for the output object assumes that the response 
variable may be reconstructed as the sum of the trend, the signal, and the
noise (residuals). Since the values of the response variable are known,
their spatial lags are used to calculate signal components (Cressie 1993, p. 564). This differs from other software, including GeoDa, which does not use knowledge of the response 
variable in making predictions for the fitting data.</p>
    </div>
    <div id="control-arguments">
    <h2>Control arguments</h2>
    
<dl><dt>tol.opt:</dt>
<dd><p>the desired accuracy of the optimization - passed to <code><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">optimize()</a></code> (default=<code>.Machine$double.eps^(2/3)</code>)</p></dd>

  <dt>fdHess:</dt>
<dd><p>default NULL, then set to (method != "eigen") internally; use <code>fdHess</code> to compute an approximate Hessian using finite differences when using sparse matrix methods; used to make a coefficient covariance matrix when the number of observations is large; may be turned off to save resources if need be</p></dd>

  <dt>optimHess:</dt>
<dd><p>default FALSE, use <code>fdHess</code> from <span class="pkg">nlme</span>, if TRUE, use <code>optim</code> to calculate Hessian at optimum</p></dd>

  <dt>optimHessMethod:</dt>
<dd><p>default “optimHess”, may be “nlm” or one of the <code>optim</code> methods</p></dd>

  <dt>Imult:</dt>
<dd><p>default 2; used for preparing the Cholesky decompositions for updating in the Jacobian function</p></dd>

  <dt>super:</dt>
<dd><p>if NULL (default), set to FALSE to use a simplicial decomposition for the sparse Cholesky decomposition and method “Matrix_J”, set to  <code>as.logical(NA)</code> for method “Matrix”, if TRUE, use a supernodal decomposition</p></dd>

  <dt>cheb_q:</dt>
<dd><p>default 5; highest power of the approximating polynomial for the Chebyshev approximation</p></dd>

  <dt>MC_p:</dt>
<dd><p>default 16; number of random variates</p></dd>

  <dt>MC_m:</dt>
<dd><p>default 30; number of products of random variates matrix and spatial weights matrix</p></dd>

  <dt>type</dt>
<dd><p>default “MC”, used with method “moments”; alternatives “mult” and “moments”, for use if <code>trs</code> is missing, <code><a href="trW.html">trW</a></code></p></dd>

  <dt>correct</dt>
<dd><p>default TRUE, used with method “moments” to compute the Smirnov/Anselin correction term</p></dd>

  <dt>trunc</dt>
<dd><p>default TRUE, used with method “moments” to truncate the Smirnov/Anselin correction term</p></dd>

  <dt>SE_method</dt>
<dd><p>default “LU”, may be “MC”</p></dd>

  <dt>nrho</dt>
<dd><p>default 200, as in SE toolbox; the size of the first stage lndet grid; it may be reduced to for example 40</p></dd>

  <dt>interpn</dt>
<dd><p>default 2000, as in SE toolbox; the size of the second stage lndet grid</p></dd>

  <dt>small_asy</dt>
<dd><p>default TRUE; if the method is not “eigen”, use asymmetric covariances rather than numerical Hessian ones if n &lt;= small</p></dd>

  <dt>small</dt>
<dd><p>default 1500; threshold number of observations for asymmetric covariances when the method is not “eigen”</p></dd>

  <dt>SElndet</dt>
<dd><p>default NULL, may be used to pass a pre-computed SE toolbox style matrix of coefficients and their lndet values to the "SE_classic" and "SE_whichMin" methods</p></dd>

  <dt>LU_order</dt>
<dd><p>default FALSE; used in “LU_prepermutate”, note warnings given for <code>lu</code> method</p></dd>

  <dt>pre_eig</dt>
<dd><p>default NULL; may be used to pass a pre-computed vector of eigenvalues</p></dd>


</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list object of class <code>Spautolm</code>:</p>
<dl><dt>fit</dt>
<dd><p>a list, with items:</p><dl><dt>coefficients</dt>
<dd><p>ML coefficient estimates</p></dd>

    <dt>SSE</dt>
<dd><p>ML sum of squared errors</p></dd>

    <dt>s2</dt>
<dd><p>ML residual variance</p></dd>

    <dt>imat</dt>
<dd><p>ML coefficient covariance matrix (before multiplying by s2)</p></dd>

    <dt>signal_trend</dt>
<dd><p>non-spatial component of fitted.values</p></dd>

    <dt>signal_stochastic</dt>
<dd><p>spatial component of fitted.values</p></dd>

    <dt>fitted.values</dt>
<dd><p>sum of non-spatial and spatial components of fitted.values</p></dd>

    <dt>residuals</dt>
<dd><p>difference between observed and fitted values</p></dd>

  
</dl></dd>

  <dt>lambda</dt>
<dd><p>ML autoregressive coefficient</p></dd>

  <dt>LL</dt>
<dd><p>log likelihood for fitted model</p></dd>

  <dt>LL0</dt>
<dd><p>log likelihood for model with lambda=0</p></dd>

  <dt>call</dt>
<dd><p>the call used to create this object</p></dd>

  <dt>parameters</dt>
<dd><p>number of parameters estimated</p></dd>

  <dt>aliased</dt>
<dd><p>if not NULL, details of aliased variables</p></dd>

  <dt>method</dt>
<dd><p>Jacobian method chosen</p></dd>

  <dt>family</dt>
<dd><p>family chosen</p></dd>

  <dt>zero.policy</dt>
<dd><p>zero.policy used</p></dd>

  <dt>weights</dt>
<dd><p>case weights used</p></dd>

  <dt>interval</dt>
<dd><p>the line search interval used</p></dd>

  <dt>timings</dt>
<dd><p>processing timings</p></dd>

  <dt>na.action</dt>
<dd><p>(possibly) named vector of excluded or omitted observations if non-default na.action argument used</p></dd>

  <dt>llprof</dt>
<dd><p>if not NULL, a list with components lambda and ll of equal length</p></dd>

  <dt>lambda.se</dt>
<dd><p>Numerical Hessian-based standard error of lambda</p></dd>

  <dt>fdHess</dt>
<dd><p>Numerical Hessian-based variance-covariance matrix</p></dd>

  <dt>X</dt>
<dd><p>covariates used in model fitting</p></dd>

  <dt>Y</dt>
<dd><p>response used in model fitting</p></dd>

  <dt>weights</dt>
<dd><p>weights used in model fitting</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Cliff, A. D., Ord, J. K. 1981 <em>Spatial processes</em>, Pion;
Ord, J. K. 1975 Estimation methods for models of spatial interaction,
<em>Journal of the American Statistical Association</em>, 70, 120-126; Waller, L. A., Gotway, C. A. 2004 <em>Applied spatial statistics for public health</em>, Wiley, Hoboken, NJ, 325-380; Cressie, N. A. C. 1993 <em>Statistics for spatial data</em>, Wiley, New York, 548-568; Ripley, B. D. 1981 <em>Spatial statistics</em>, Wiley, New York, 88-95; LeSage J and RK Pace (2009) Introduction to Spatial Econometrics. CRC Press, Boca Raton.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The standard errors given in Waller and Gotway (2004) are adjusted for the numbers of parameters estimated, and may be reproduced by using the additional argument <code>adj.se=TRUE</code> in the <code>summary</code> method. In addition, the function returns fitted values and residuals as given by Cressie (1993) p. 564.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">optimize</a></code>, <code><a href="ML_models.html">errorsarlm</a></code>, <code><a href="do_ldet.html">do_ldet</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://r-spatial.github.io/sf/" class="external-link">"sf"</a></span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"shapes/NY8_bna_utm18.gpkg"</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">lm0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>, data<span class="op">=</span><span class="va">nydata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = nydata)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.7417 -0.3957 -0.0326  0.3353  4.1398 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.51728    0.15856  -3.262  0.00124 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.04884    0.03506   1.393  0.16480    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    3.95089    0.60550   6.525 3.22e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.56004    0.17031  -3.288  0.00114 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.6571 on 277 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.1932,	Adjusted R-squared:  0.1844 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic:  22.1 on 3 and 277 DF,  p-value: 7.306e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">lm0w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>, data<span class="op">=</span><span class="va">nydata</span>, weights<span class="op">=</span><span class="va">POP8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm0w</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = nydata, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     weights = POP8)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Weighted Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -129.067  -14.714    5.817   25.624   70.723 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.77837    0.14116  -5.514 8.03e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.07626    0.02731   2.792  0.00560 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    3.85656    0.57126   6.751 8.60e-11 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.39869    0.15305  -2.605  0.00968 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 33.5 on 277 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.1977,	Adjusted R-squared:  0.189 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 22.75 on 3 and 277 DF,  p-value: 3.382e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="va">nyadjmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">foreign</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.dbf.html" class="external-link">read.dbf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="st">"misc/nyadjwts.dbf"</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu">foreign</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.dbf.html" class="external-link">read.dbf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="st">"misc/nyadjwts.dbf"</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">ID</span>, <span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">nydata</span><span class="op">$</span><span class="va">AREAKEY</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="co">#require("spdep", quietly=TRUE)</span></span></span>
<span class="r-in"><span><span class="va">listw_NY</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/mat2listw.html" class="external-link">mat2listw</a></span><span class="op">(</span><span class="va">nyadjmat</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">nydata</span><span class="op">$</span><span class="va">AREAKEY</span><span class="op">)</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">eigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="eigenw.html">eigenw</a></span><span class="op">(</span><span class="va">listw_NY</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">esar0</span> <span class="op">&lt;-</span> <span class="fu"><a href="ML_models.html">errorsarlm</a></span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>, data<span class="op">=</span><span class="va">nydata</span>,</span></span>
<span class="r-in"><span> listw<span class="op">=</span><span class="va">listw_NY</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esar0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:errorsarlm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = nydata, listw = listw_NY)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.56754 -0.38239 -0.02643  0.33109  4.01219 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: error </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (asymptotic standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.618193   0.176784 -3.4969 0.0004707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.071014   0.042051  1.6888 0.0912635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    3.754200   0.624722  6.0094 1.862e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.419890   0.191329 -2.1946 0.0281930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.040487, LR test value: 5.2438, p-value: 0.022026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 0.016214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 2.4971, p-value: 0.01252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald statistic: 6.2356, p-value: 0.01252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -276.1069 for error model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 0.41388, (sigma: 0.64333)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 564.21, (AIC for lm: 567.46)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">esar1f</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>,</span></span>
<span class="r-in"><span> data<span class="op">=</span><span class="va">nydata</span>, listw<span class="op">=</span><span class="va">listw_NY</span>, family<span class="op">=</span><span class="st">"SAR"</span>, method<span class="op">=</span><span class="st">"eigen"</span>,</span></span>
<span class="r-in"><span> control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">eigs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.196   0.000   0.197 </span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esar1f</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spautolm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = nydata, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     listw = listw_NY, family = "SAR", method = "eigen", control = list(pre_eig = eigs))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.56754 -0.38239 -0.02643  0.33109  4.01219 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.618193   0.176784 -3.4969 0.0004707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.071014   0.042051  1.6888 0.0912635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    3.754200   0.624722  6.0094 1.862e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.419890   0.191329 -2.1946 0.0281930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.040487 LR test value: 5.2438 p-value: 0.022026 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Numerical Hessian standard error of lambda: 0.017201 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -276.1069 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 0.41388, (sigma: 0.64333)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 564.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Estimate Std. Error   z value     Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.61819272 0.17678351 -3.496891 4.707136e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.07101384 0.04205063  1.688770 9.126350e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    3.75419996 0.62472153  6.009397 1.862142e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.41988960 0.19132936 -2.194591 2.819298e-02</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">resvar</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   PEXPOSURE   PCTAGE65P  PCTOWNHOME </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.17678351  0.04205063  0.62472153  0.19132936 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">esar1f</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">imat</span><span class="op">)</span><span class="op">*</span><span class="va">esar1f</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">s2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   PEXPOSURE   PCTAGE65P  PCTOWNHOME </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.17678351  0.04205063  0.62472153  0.19132936 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">esar1f</span><span class="op">$</span><span class="va">fdHess</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.01720109 0.18504698 0.04378056 0.62990270 0.20343911</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">esar1M</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>,</span></span>
<span class="r-in"><span> data<span class="op">=</span><span class="va">nydata</span>, listw<span class="op">=</span><span class="va">listw_NY</span>, family<span class="op">=</span><span class="st">"SAR"</span>, method<span class="op">=</span><span class="st">"Matrix"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.221   0.000   0.221 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esar1M</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spautolm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = nydata, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     listw = listw_NY, family = "SAR", method = "Matrix")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.406132 -0.561646 -0.092662  0.474796  5.384405 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.414826   0.102166 -4.0603 4.901e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.015081   0.017772  0.8486    0.3961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    5.159749   0.476498 10.8285 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.892387   0.099241 -8.9921 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: -0.38889 LR test value: 254.73 p-value: &lt; 2.22e-16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Numerical Hessian standard error of lambda: 0.044857 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -151.3662 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 0.95111, (sigma: 0.97525)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 314.73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">esar1M</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>,</span></span>
<span class="r-in"><span> data<span class="op">=</span><span class="va">nydata</span>, listw<span class="op">=</span><span class="va">listw_NY</span>, family<span class="op">=</span><span class="st">"SAR"</span>, method<span class="op">=</span><span class="st">"Matrix"</span>,</span></span>
<span class="r-in"><span> control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>super<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.196   0.000   0.196 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esar1M</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spautolm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = nydata, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     listw = listw_NY, family = "SAR", method = "Matrix", control = list(super = TRUE))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.178535 -0.521860 -0.074421  0.414212  5.184465 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.411041   0.104426 -3.9362 8.279e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.015768   0.018366  0.8585    0.3906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    5.070130   0.483332 10.4900 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.880883   0.102093 -8.6282 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: -0.33146 LR test value: 247.44 p-value: &lt; 2.22e-16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Numerical Hessian standard error of lambda: 0.030659 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -155.0108 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 0.82436, (sigma: 0.90795)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 322.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">esar1wf</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>, data<span class="op">=</span><span class="va">nydata</span>,</span></span>
<span class="r-in"><span> listw<span class="op">=</span><span class="va">listw_NY</span>, weights<span class="op">=</span><span class="va">POP8</span>, family<span class="op">=</span><span class="st">"SAR"</span>, method<span class="op">=</span><span class="st">"eigen"</span>,</span></span>
<span class="r-in"><span> control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">eigs</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esar1wf</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spautolm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = nydata, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     listw = listw_NY, weights = POP8, family = "SAR", method = "eigen", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     control = list(pre_eig = eigs))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.48488 -0.26823  0.09489  0.46552  4.28343 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.797063   0.144054 -5.5331 3.146e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.080545   0.028334  2.8428  0.004473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    3.816731   0.576037  6.6258 3.453e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.380778   0.156507 -2.4330  0.014975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.0095636 LR test value: 0.32665 p-value: 0.56764 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Numerical Hessian standard error of lambda: 0.016522 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -251.6017 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 1104.1, (sigma: 33.229)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: NA (not available for weighted model)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">esar1wM</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>,</span></span>
<span class="r-in"><span> data<span class="op">=</span><span class="va">nydata</span>, listw<span class="op">=</span><span class="va">listw_NY</span>, weights<span class="op">=</span><span class="va">POP8</span>, family<span class="op">=</span><span class="st">"SAR"</span>, method<span class="op">=</span><span class="st">"Matrix"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.212   0.000   0.214 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esar1wM</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spautolm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = nydata, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     listw = listw_NY, weights = POP8, family = "SAR", method = "Matrix")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.561100 -0.374524  0.057405  0.591094  5.700142 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.578546   0.090006 -6.4279 1.294e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.035402   0.013959  2.5361   0.01121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    4.651137   0.421285 11.0404 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.666898   0.091443 -7.2931 3.029e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: -0.34423 LR test value: 264.24 p-value: &lt; 2.22e-16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Numerical Hessian standard error of lambda: 0.036776 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -119.6468 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 2129.1, (sigma: 46.142)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: NA (not available for weighted model)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">esar1wlu</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>, data<span class="op">=</span><span class="va">nydata</span>,</span></span>
<span class="r-in"><span> listw<span class="op">=</span><span class="va">listw_NY</span>, weights<span class="op">=</span><span class="va">POP8</span>, family<span class="op">=</span><span class="st">"SAR"</span>, method<span class="op">=</span><span class="st">"LU"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esar1wlu</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spautolm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = nydata, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     listw = listw_NY, weights = POP8, family = "SAR", method = "LU")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.48488 -0.26823  0.09489  0.46552  4.28343 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.797063   0.144054 -5.5331 3.146e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.080545   0.028334  2.8428  0.004473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    3.816731   0.576037  6.6258 3.453e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.380778   0.156507 -2.4330  0.014975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.0095636 LR test value: 0.32665 p-value: 0.56764 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Numerical Hessian standard error of lambda: 0.016522 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -251.6017 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 1104.1, (sigma: 33.229)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: NA (not available for weighted model)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">esar1wch</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>, data<span class="op">=</span><span class="va">nydata</span>,</span></span>
<span class="r-in"><span> listw<span class="op">=</span><span class="va">listw_NY</span>, weights<span class="op">=</span><span class="va">POP8</span>, family<span class="op">=</span><span class="st">"SAR"</span>, method<span class="op">=</span><span class="st">"Chebyshev"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esar1wch</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spautolm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = nydata, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     listw = listw_NY, weights = POP8, family = "SAR", method = "Chebyshev")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.39831 -0.86303  0.12117  1.09320  8.78570 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.538555   0.087573 -6.1498  7.76e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.029782   0.013074  2.2780   0.02273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    4.896346   0.419359 11.6758 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.737829   0.087569 -8.4257 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: -1 LR test value: 236970 p-value: &lt; 2.22e-16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Numerical Hessian standard error of lambda: NaN </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: 118232.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 9336.4, (sigma: 96.625)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: NA (not available for weighted model)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="va">ecar1f</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>, data<span class="op">=</span><span class="va">nydata</span>,</span></span>
<span class="r-in"><span> listw<span class="op">=</span><span class="va">listw_NY</span>, family<span class="op">=</span><span class="st">"CAR"</span>, method<span class="op">=</span><span class="st">"eigen"</span>,</span></span>
<span class="r-in"><span> control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">eigs</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ecar1f</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spautolm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = nydata, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     listw = listw_NY, family = "CAR", method = "eigen", control = list(pre_eig = eigs))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.539732 -0.384311 -0.030646  0.335126  3.808848 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.648362   0.181129 -3.5796 0.0003442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.077899   0.043692  1.7829 0.0745986</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    3.703830   0.627185  5.9055 3.516e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.382789   0.195564 -1.9574 0.0503053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.084123 LR test value: 5.8009 p-value: 0.016018 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Numerical Hessian standard error of lambda: 0.030872 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -275.8283 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 0.40758, (sigma: 0.63842)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 563.66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">ecar1M</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>,</span></span>
<span class="r-in"><span> data<span class="op">=</span><span class="va">nydata</span>, listw<span class="op">=</span><span class="va">listw_NY</span>, family<span class="op">=</span><span class="st">"CAR"</span>, method<span class="op">=</span><span class="st">"Matrix"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.236   0.000   0.237 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ecar1M</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spautolm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = nydata, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     listw = listw_NY, family = "CAR", method = "Matrix")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.449951 -0.633777 -0.072436  0.550248  6.039594 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.402788   0.112612 -3.5768 0.0003479</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.020131   0.020783  0.9686 0.3327222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    4.632644   0.500526  9.2555 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.812981   0.112867 -7.2030 5.891e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: -0.5 LR test value: 228.48 p-value: &lt; 2.22e-16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Numerical Hessian standard error of lambda: NaN </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -164.4897 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 0.50386, (sigma: 0.70983)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 340.98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="va">ecar1wf</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>, data<span class="op">=</span><span class="va">nydata</span>,</span></span>
<span class="r-in"><span> listw<span class="op">=</span><span class="va">listw_NY</span>, weights<span class="op">=</span><span class="va">POP8</span>, family<span class="op">=</span><span class="st">"CAR"</span>, method<span class="op">=</span><span class="st">"eigen"</span>,</span></span>
<span class="r-in"><span> control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">eigs</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ecar1wf</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spautolm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = nydata, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     listw = listw_NY, weights = POP8, family = "CAR", method = "eigen", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     control = list(pre_eig = eigs))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.491042 -0.270906  0.081435  0.451556  4.198134 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.790154   0.144862 -5.4545 4.910e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.081922   0.028593  2.8651  0.004169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    3.825858   0.577720  6.6223 3.536e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.386820   0.157436 -2.4570  0.014010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.022419 LR test value: 0.38785 p-value: 0.53343 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Numerical Hessian standard error of lambda: 0.038977 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -251.5711 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 1102.9, (sigma: 33.21)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: NA (not available for weighted model)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">ecar1wM</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>,</span></span>
<span class="r-in"><span> data<span class="op">=</span><span class="va">nydata</span>, listw<span class="op">=</span><span class="va">listw_NY</span>, weights<span class="op">=</span><span class="va">POP8</span>, family<span class="op">=</span><span class="st">"CAR"</span>, method<span class="op">=</span><span class="st">"Matrix"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.243   0.000   0.244 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ecar1wM</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spautolm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = nydata, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     listw = listw_NY, weights = POP8, family = "CAR", method = "Matrix")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.98144 -0.15716  0.37342  1.08857  7.10495 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.714952   0.093905 -7.6136 2.665e-14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.041467   0.015279  2.7139   0.00665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    4.149207   0.425446  9.7526 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.478396   0.097030 -4.9304 8.205e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: -0.5 LR test value: 262.65 p-value: &lt; 2.22e-16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Numerical Hessian standard error of lambda: NaN </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -120.4395 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 1159.2, (sigma: 34.046)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: NA (not available for weighted model)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://r-spatial.github.io/sf/" class="external-link">"sf"</a></span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nc.sids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"shapes/sids.shp"</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ft.SID74</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">SID74</span><span class="op">/</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">BIR74</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">SID74</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">BIR74</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lm_nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sids.nhbr30</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/dnearneigh.html" class="external-link">dnearneigh</a></span><span class="op">(</span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">east</span>, <span class="va">nc.sids</span><span class="op">$</span><span class="va">north</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">30</span>,</span></span>
<span class="r-in"><span> row.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sids.nhbr30.dist</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nbdists.html" class="external-link">nbdists</a></span><span class="op">(</span><span class="va">sids.nhbr30</span>, <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">east</span>, <span class="va">nc.sids</span><span class="op">$</span><span class="va">north</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sids.nhbr</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/listw2sn.html" class="external-link">listw2sn</a></span><span class="op">(</span><span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">sids.nhbr30</span>,</span></span>
<span class="r-in"><span> glist<span class="op">=</span><span class="va">sids.nhbr30.dist</span>, style<span class="op">=</span><span class="st">"B"</span>, zero.policy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dij</span> <span class="op">&lt;-</span> <span class="va">sids.nhbr</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="va">nc.sids</span><span class="op">$</span><span class="va">BIR74</span></span></span>
<span class="r-in"><span><span class="va">el1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">dij</span><span class="op">)</span><span class="op">/</span><span class="va">dij</span></span></span>
<span class="r-in"><span><span class="va">el2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">[</span><span class="va">sids.nhbr</span><span class="op">$</span><span class="va">to</span><span class="op">]</span><span class="op">/</span><span class="va">n</span><span class="op">[</span><span class="va">sids.nhbr</span><span class="op">$</span><span class="va">from</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sids.nhbr</span><span class="op">$</span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">el1</span><span class="op">*</span><span class="va">el2</span></span></span>
<span class="r-in"><span><span class="va">sids.nhbr.listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/listw2sn.html" class="external-link">sn2listw</a></span><span class="op">(</span><span class="va">sids.nhbr</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>style is M (missing); style should be set to a valid value</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>56, 87 are not origins</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in spdep::sn2listw(sids.nhbr):</span> no-neighbour observations found, set zero.policy to TRUE</span>
<span class="r-in"><span><span class="va">both</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">L_id</span>, <span class="va">nc.sids</span><span class="op">$</span><span class="va">M_id</span>, sep<span class="op">=</span><span class="st">":"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ft.NWBIR74</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">NWBIR74</span><span class="op">/</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">BIR74</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">NWBIR74</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">BIR74</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">both</span>, <span class="va">ft.NWBIR74</span>, <span class="va">ft.SID74</span>, BIR74<span class="op">=</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">BIR74</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">rstandard</a></span><span class="op">(</span><span class="va">lm_nc</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">NAME</span><span class="op">[</span><span class="va">outl</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Anson"</span>
<span class="r-in"><span><span class="va">mdata.4</span> <span class="op">&lt;-</span> <span class="va">mdata</span><span class="op">[</span><span class="op">-</span><span class="va">outl</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2mat.html" class="external-link">listw2mat</a></span><span class="op">(</span><span class="va">sids.nhbr.listw</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'sids.nhbr.listw' not found</span>
<span class="r-in"><span><span class="va">W.4</span> <span class="op">&lt;-</span> <span class="va">W</span><span class="op">[</span><span class="op">-</span><span class="va">outl</span>, <span class="op">-</span><span class="va">outl</span><span class="op">]</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'W' not found</span>
<span class="r-in"><span><span class="va">sids.nhbr.listw.4</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/mat2listw.html" class="external-link">mat2listw</a></span><span class="op">(</span><span class="va">W.4</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'W.4' not found</span>
<span class="r-in"><span><span class="va">esarI</span> <span class="op">&lt;-</span> <span class="fu"><a href="ML_models.html">errorsarlm</a></span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">mdata</span>, listw<span class="op">=</span><span class="va">sids.nhbr.listw</span>,</span></span>
<span class="r-in"><span> zero.policy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'sids.nhbr.listw' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esarI</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'summary': object 'esarI' not found</span>
<span class="r-in"><span><span class="va">esarIa</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">mdata</span>, listw<span class="op">=</span><span class="va">sids.nhbr.listw</span>,</span></span>
<span class="r-in"><span> family<span class="op">=</span><span class="st">"SAR"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'sids.nhbr.listw' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esarIa</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'summary': object 'esarIa' not found</span>
<span class="r-in"><span><span class="va">esarIV</span> <span class="op">&lt;-</span> <span class="fu"><a href="ML_models.html">errorsarlm</a></span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="va">ft.NWBIR74</span>, data<span class="op">=</span><span class="va">mdata</span>, listw<span class="op">=</span><span class="va">sids.nhbr.listw</span>,</span></span>
<span class="r-in"><span> zero.policy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'sids.nhbr.listw' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esarIV</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'summary': object 'esarIV' not found</span>
<span class="r-in"><span><span class="va">esarIVa</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="va">ft.NWBIR74</span>, data<span class="op">=</span><span class="va">mdata</span>, listw<span class="op">=</span><span class="va">sids.nhbr.listw</span>,</span></span>
<span class="r-in"><span> family<span class="op">=</span><span class="st">"SAR"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'sids.nhbr.listw' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esarIVa</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'summary': object 'esarIVa' not found</span>
<span class="r-in"><span><span class="va">esarIaw</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">mdata</span>, listw<span class="op">=</span><span class="va">sids.nhbr.listw</span>,</span></span>
<span class="r-in"><span> weights<span class="op">=</span><span class="va">BIR74</span>, family<span class="op">=</span><span class="st">"SAR"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'sids.nhbr.listw' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esarIaw</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'summary': object 'esarIaw' not found</span>
<span class="r-in"><span><span class="va">esarIIaw</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="va">both</span> <span class="op">-</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">mdata</span>, listw<span class="op">=</span><span class="va">sids.nhbr.listw</span>,</span></span>
<span class="r-in"><span> weights<span class="op">=</span><span class="va">BIR74</span>, family<span class="op">=</span><span class="st">"SAR"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'sids.nhbr.listw' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esarIIaw</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'summary': object 'esarIIaw' not found</span>
<span class="r-in"><span><span class="va">esarIVaw</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="va">ft.NWBIR74</span>, data<span class="op">=</span><span class="va">mdata</span>,</span></span>
<span class="r-in"><span> listw<span class="op">=</span><span class="va">sids.nhbr.listw</span>, weights<span class="op">=</span><span class="va">BIR74</span>, family<span class="op">=</span><span class="st">"SAR"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'sids.nhbr.listw' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esarIVaw</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'summary': object 'esarIVaw' not found</span>
<span class="r-in"><span><span class="va">ecarIaw</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">mdata.4</span>, listw<span class="op">=</span><span class="va">sids.nhbr.listw.4</span>,</span></span>
<span class="r-in"><span> weights<span class="op">=</span><span class="va">BIR74</span>, family<span class="op">=</span><span class="st">"CAR"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'sids.nhbr.listw.4' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ecarIaw</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'summary': object 'ecarIaw' not found</span>
<span class="r-in"><span><span class="va">ecarIIaw</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="va">both</span> <span class="op">-</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">mdata.4</span>,</span></span>
<span class="r-in"><span> listw<span class="op">=</span><span class="va">sids.nhbr.listw.4</span>, weights<span class="op">=</span><span class="va">BIR74</span>, family<span class="op">=</span><span class="st">"CAR"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'sids.nhbr.listw.4' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ecarIIaw</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'summary': object 'ecarIIaw' not found</span>
<span class="r-in"><span><span class="va">ecarIVaw</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">ft.SID74</span> <span class="op">~</span> <span class="va">ft.NWBIR74</span>, data<span class="op">=</span><span class="va">mdata.4</span>,</span></span>
<span class="r-in"><span> listw<span class="op">=</span><span class="va">sids.nhbr.listw.4</span>, weights<span class="op">=</span><span class="va">BIR74</span>, family<span class="op">=</span><span class="st">"CAR"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'sids.nhbr.listw.4' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ecarIVaw</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'summary': object 'ecarIVaw' not found</span>
<span class="r-in"><span><span class="va">nc.sids</span><span class="op">$</span><span class="va">fitIV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted.values</a></span><span class="op">(</span><span class="va">ecarIVaw</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">outl</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'ecarIVaw' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">[</span>,<span class="st">"fitIV"</span><span class="op">]</span>, nbreaks<span class="op">=</span><span class="fl">12</span><span class="op">)</span> <span class="co"># Cressie 1993, p. 565</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in `[.data.frame`(x, i, j, drop = drop):</span> undefined columns selected</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">oldcol</span>, package<span class="op">=</span><span class="st">"spdep"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu"><a href="ML_models.html">errorsarlm</a></span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span>, style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> errorsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = spdep::nb2listw(COL.nb, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     style = "W"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -34.81174  -6.44031  -0.72142   7.61476  23.33626 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: error </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (asymptotic standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 59.893219   5.366163 11.1613 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -0.941312   0.330569 -2.8476 0.0044057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.302250   0.090476 -3.3407 0.0008358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.56179, LR test value: 7.9935, p-value: 0.0046945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 0.13387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 4.1966, p-value: 2.7098e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald statistic: 17.611, p-value: 2.7098e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -183.3805 for error model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 95.575, (sigma: 9.7762)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 376.76, (AIC for lm: 382.75)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">COL.errW.sar</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span>, style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.errW.sar</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spautolm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = spdep::nb2listw(COL.nb, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     style = "W"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -34.81174  -6.44031  -0.72142   7.61476  23.33626 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 59.893219   5.366162 11.1613 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -0.941312   0.330569 -2.8476 0.0044057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.302250   0.090476 -3.3407 0.0008358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.56179 LR test value: 7.9935 p-value: 0.0046945 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Numerical Hessian standard error of lambda: 0.15241 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -183.3805 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 95.575, (sigma: 9.7762)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 376.76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">boston</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gp1</span> <span class="op">&lt;-</span> <span class="fu">spautolm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">CMEDV</span><span class="op">)</span> <span class="op">~</span> <span class="va">CRIM</span> <span class="op">+</span> <span class="va">ZN</span> <span class="op">+</span> <span class="va">INDUS</span> <span class="op">+</span> <span class="va">CHAS</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">NOX</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">RM</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">AGE</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">DIS</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">RAD</span><span class="op">)</span> <span class="op">+</span> <span class="va">TAX</span> <span class="op">+</span> <span class="va">PTRATIO</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">LSTAT</span><span class="op">)</span>, </span></span>
<span class="r-in"><span> data<span class="op">=</span><span class="va">boston.c</span>, <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">boston.soi</span><span class="op">)</span>, family<span class="op">=</span><span class="st">"SMA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gp1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: spautolm(formula = log(CMEDV) ~ CRIM + ZN + INDUS + CHAS + I(NOX^2) + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     I(RM^2) + AGE + log(DIS) + log(RAD) + TAX + PTRATIO + B + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     log(LSTAT), data = boston.c, listw = spdep::nb2listw(boston.soi), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = "SMA")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Min         1Q     Median         3Q        Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.5847694 -0.0713881  0.0012284  0.0827517  0.6071219 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Estimate  Std. Error  z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  4.28501607  0.15367176  27.8842 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CRIM        -0.00718807  0.00106298  -6.7622 1.359e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ZN           0.00023008  0.00051897   0.4433 0.6575185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INDUS        0.00047300  0.00263339   0.1796 0.8574551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CHAS1        0.01020698  0.02872047   0.3554 0.7222970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(NOX^2)    -0.44885530  0.13675913  -3.2821 0.0010304</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(RM^2)      0.00638094  0.00110330   5.7835 7.316e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AGE         -0.00043973  0.00051336  -0.8566 0.3916862</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(DIS)    -0.15650578  0.03856337  -4.0584 4.941e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(RAD)     0.07583760  0.02016468   3.7609 0.0001693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TAX         -0.00049364  0.00012162  -4.0588 4.933e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PTRATIO     -0.02494959  0.00538791  -4.6307 3.645e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B            0.00048517  0.00010944   4.4334 9.277e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(LSTAT)  -0.32961379  0.02353891 -14.0029 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.61991 LR test value: 144.28 p-value: &lt; 2.22e-16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Numerical Hessian standard error of lambda: 0.044296 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: 229.1208 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 0.02596, (sigma: 0.16112)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 506 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -426.24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Roger Bivand, Gianfranco Piras.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

