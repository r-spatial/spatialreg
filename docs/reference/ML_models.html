<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Spatial simultaneous autoregressive model estimation by maximum likelihood — ML_models • spatialreg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial simultaneous autoregressive model estimation by maximum likelihood — ML_models"><meta name="description" content="The lagsarlm function provides Maximum likelihood estimation of spatial simultaneous autoregressive lag and spatial Durbin (mixed) models of the form:
$$y = \rho W y + X \beta + \varepsilon$$
where \(\rho\) is found by optimize() first, and \(\beta\) and other parameters by generalized least squares subsequently (one-dimensional search using optim performs badly on some platforms). In the spatial Durbin (mixed) model, the spatially lagged independent variables are added to X. Note that interpretation of the fitted coefficients should use impact measures, because of the feedback loops induced by the data generation process for this model. With one of the sparse matrix methods, larger numbers of observations can be handled, but the interval= argument may need be set when the weights are not row-standardised.
Maximum likelihood estimation of spatial simultaneous autoregressive
error models of the form:
$$y = X \beta + u, u = \lambda W u + \varepsilon$$
where \(\lambda\) is found by optimize() first, and \(\beta\) and other parameters by generalized least squares subsequently. With one of the sparse matrix methods, larger numbers of observations can be handled, but the interval= argument may need be set when the weights are not row-standardised. When etype is &amp;#8220;emixed&amp;#8221;, a so-called spatial Durbin error model is fitted.
Maximum likelihood estimation of spatial simultaneous autoregressive
&amp;#8220;SAC/SARAR&amp;#8221; models of the form:
$$y = \rho W1 y + X \beta + u, u = \lambda W2 u + \varepsilon$$
where \(\rho\) and \(\lambda\) are found by nlminb or optim() first, and \(\beta\) and other parameters by generalized least squares subsequently.

"><meta property="og:description" content="The lagsarlm function provides Maximum likelihood estimation of spatial simultaneous autoregressive lag and spatial Durbin (mixed) models of the form:
$$y = \rho W y + X \beta + \varepsilon$$
where \(\rho\) is found by optimize() first, and \(\beta\) and other parameters by generalized least squares subsequently (one-dimensional search using optim performs badly on some platforms). In the spatial Durbin (mixed) model, the spatially lagged independent variables are added to X. Note that interpretation of the fitted coefficients should use impact measures, because of the feedback loops induced by the data generation process for this model. With one of the sparse matrix methods, larger numbers of observations can be handled, but the interval= argument may need be set when the weights are not row-standardised.
Maximum likelihood estimation of spatial simultaneous autoregressive
error models of the form:
$$y = X \beta + u, u = \lambda W u + \varepsilon$$
where \(\lambda\) is found by optimize() first, and \(\beta\) and other parameters by generalized least squares subsequently. With one of the sparse matrix methods, larger numbers of observations can be handled, but the interval= argument may need be set when the weights are not row-standardised. When etype is &amp;#8220;emixed&amp;#8221;, a so-called spatial Durbin error model is fitted.
Maximum likelihood estimation of spatial simultaneous autoregressive
&amp;#8220;SAC/SARAR&amp;#8221; models of the form:
$$y = \rho W1 y + X \beta + u, u = \lambda W2 u + \varepsilon$$
where \(\rho\) and \(\lambda\) are found by nlminb or optim() first, and \(\beta\) and other parameters by generalized least squares subsequently.

"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spatialreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3-6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a></li>
    <li><a class="dropdown-item" href="../articles/sids_models.html">North Carolina SIDS data set (models)</a></li>
    <li><a class="dropdown-item" href="../articles/SpatialFiltering.html">Moran Eigenvectors</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-spatial/spatialreg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Spatial simultaneous autoregressive model estimation by maximum likelihood</h1>

      <div class="d-none name"><code>ML_models.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>lagsarlm</code> function provides Maximum likelihood estimation of spatial simultaneous autoregressive lag and spatial Durbin (mixed) models of the form:</p>
<p>$$y = \rho W y + X \beta + \varepsilon$$</p>
<p>where \(\rho\) is found by <code><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">optimize()</a></code> first, and \(\beta\) and other parameters by generalized least squares subsequently (one-dimensional search using optim performs badly on some platforms). In the spatial Durbin (mixed) model, the spatially lagged independent variables are added to X. Note that interpretation of the fitted coefficients should use impact measures, because of the feedback loops induced by the data generation process for this model. With one of the sparse matrix methods, larger numbers of observations can be handled, but the <code>interval=</code> argument may need be set when the weights are not row-standardised.</p>
<p>Maximum likelihood estimation of spatial simultaneous autoregressive
error models of the form:</p>
<p>$$y = X \beta + u, u = \lambda W u + \varepsilon$$</p>
<p>where \(\lambda\) is found by <code><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">optimize()</a></code> first, and \(\beta\) and other parameters by generalized least squares subsequently. With one of the sparse matrix methods, larger numbers of observations can be handled, but the <code>interval=</code> argument may need be set when the weights are not row-standardised. When <code>etype</code> is “emixed”, a so-called spatial Durbin error model is fitted.</p>
<p>Maximum likelihood estimation of spatial simultaneous autoregressive
“SAC/SARAR” models of the form:</p>
<p>$$y = \rho W1 y + X \beta + u, u = \lambda W2 u + \varepsilon$$</p>
<p>where \(\rho\) and \(\lambda\) are found by <code>nlminb</code> or <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code> first, and \(\beta\) and other parameters by generalized least squares subsequently.</p>


    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lagsarlm</span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">listw</span>, <span class="va">na.action</span>, <span class="va">Durbin</span>, <span class="va">type</span>,</span>
<span> method<span class="op">=</span><span class="st">"eigen"</span>, quiet<span class="op">=</span><span class="cn">NULL</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span>, interval<span class="op">=</span><span class="cn">NULL</span>,</span>
<span> tol.solve<span class="op">=</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>, trs<span class="op">=</span><span class="cn">NULL</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">errorsarlm</span><span class="op">(</span><span class="va">formula</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">listw</span>, <span class="va">na.action</span>, weights<span class="op">=</span><span class="cn">NULL</span>,</span>
<span> <span class="va">Durbin</span>, <span class="va">etype</span>, method<span class="op">=</span><span class="st">"eigen"</span>, quiet<span class="op">=</span><span class="cn">NULL</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span>,</span>
<span> interval <span class="op">=</span> <span class="cn">NULL</span>, tol.solve<span class="op">=</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>, trs<span class="op">=</span><span class="cn">NULL</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">sacsarlm</span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">listw</span>, listw2 <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">na.action</span>, <span class="va">Durbin</span>, <span class="va">type</span>,</span>
<span> method<span class="op">=</span><span class="st">"eigen"</span>, quiet<span class="op">=</span><span class="cn">NULL</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span>, tol.solve<span class="op">=</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>,</span>
<span> llprof<span class="op">=</span><span class="cn">NULL</span>, interval1<span class="op">=</span><span class="cn">NULL</span>, interval2<span class="op">=</span><span class="cn">NULL</span>, trs1<span class="op">=</span><span class="cn">NULL</span>, trs2<span class="op">=</span><span class="cn">NULL</span>,</span>
<span> control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'Sarlm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, correlation <span class="op">=</span> <span class="cn">FALSE</span>, Nagelkerke <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span> Hausman<span class="op">=</span><span class="cn">FALSE</span>, adj.se<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'Sarlm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'summary.Sarlm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">5</span>, <span class="va">.Options</span><span class="op">$</span><span class="va">digits</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span> signif.stars <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'Sarlm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'Sarlm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'Sarlm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'Sarlm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'Sarlm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a symbolic description of the model to be fit. The details
of model specification are given for <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code></p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment which the function
is called.</p></dd>

  <dt id="arg-listw-listw-">listw, listw2<a class="anchor" aria-label="anchor" href="#arg-listw-listw-"></a></dt>
<dd><p>a <code>listw</code> object created for example by <code>nb2listw</code>; if <code>nb2listw</code> not given, set to the same spatial weights as the <code>listw</code> argument</p></dd>

  <dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>a function (default <code>options("na.action")</code>), can also be <code>na.omit</code> or <code>na.exclude</code> with consequences for residuals and fitted values - in these cases the weights list will be subsetted to remove NAs in the data. It may be necessary to set zero.policy to TRUE because this subsetting may create no-neighbour observations. Note that only weights lists created without using the glist argument to <code>nb2listw</code> may be subsetted.</p></dd>

  <dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>an optional vector of weights to be used in the fitting process. Non-NULL weights can be used to indicate that different observations have different variances (with the values in weights being inversely proportional to the variances); or equivalently, when the elements of weights are positive integers w_i, that each response y_i is the mean of w_i unit-weight observations (including the case that there are w_i observations equal to y_i and the data have been summarized) - <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code></p></dd>

  <dt id="arg-durbin">Durbin<a class="anchor" aria-label="anchor" href="#arg-durbin"></a></dt>
<dd><p>default FALSE (spatial lag model); if TRUE, full spatial Durbin model; if a formula object, the subset of explanatory variables to lag</p></dd>

  <dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>(use the ‘Durbin=’ argument - retained for backwards compatibility only) default "lag", may be set to "mixed"; when "mixed", the lagged intercept is dropped for spatial weights style "W", that is row-standardised weights, but otherwise included; “Durbin” may be used instead of “mixed”</p></dd>

  <dt id="arg-etype">etype<a class="anchor" aria-label="anchor" href="#arg-etype"></a></dt>
<dd><p>(use the ‘Durbin=’ argument - retained for backwards compatibility only) default "error", may be set to "emixed" to include the spatially lagged independent variables added to X; when "emixed", the lagged intercept is dropped for spatial weights style "W", that is row-standardised weights, but otherwise included</p></dd>

  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>"eigen" (default) - the Jacobian is computed as the product
of (1 - rho*eigenvalue) using <code>eigenw</code>, and "spam" or "Matrix_J" for strictly symmetric weights lists of styles "B" and "C", or made symmetric by similarity (Ord, 1975, Appendix C) if possible for styles "W" and "S", using code from the spam or Matrix packages to calculate the determinant; “Matrix” and “spam_update” provide updating Cholesky decomposition methods; "LU" provides an alternative sparse matrix decomposition approach. In addition, there are "Chebyshev" and Monte Carlo "MC" approximate log-determinant methods; the Smirnov/Anselin (2009) trace approximation is available as "moments". Three methods: "SE_classic", "SE_whichMin", and "SE_interp" are provided experimentally, the first to attempt to emulate the behaviour of Spatial Econometrics toolbox ML fitting functions. All use grids of log determinant values, and the latter two attempt to ameliorate some features of "SE_classic".</p></dd>

  <dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>default NULL, use !verbose global option value; if FALSE, reports function values during optimization.</p></dd>

  <dt id="arg-zero-policy">zero.policy<a class="anchor" aria-label="anchor" href="#arg-zero-policy"></a></dt>
<dd><p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without
neighbours, if FALSE (default) assign NA - causing <code>lagsarlm()</code> to terminate with an error</p></dd>

  <dt id="arg-interval">interval<a class="anchor" aria-label="anchor" href="#arg-interval"></a></dt>
<dd><p>default is NULL, search interval for autoregressive parameter</p></dd>

  <dt id="arg-tol-solve">tol.solve<a class="anchor" aria-label="anchor" href="#arg-tol-solve"></a></dt>
<dd><p>the tolerance for detecting linear dependencies in the columns of matrices to be inverted - passed to <code><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve()</a></code> (default=1.0e-10). This may be used if necessary to extract coefficient standard errors (for instance lowering to 1e-12), but errors in <code><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve()</a></code> may constitute indications of poorly scaled variables: if the variables have scales differing much from the autoregressive coefficient, the values in this matrix may be very different in scale, and inverting such a matrix is analytically possible by definition, but numerically unstable; rescaling the RHS variables alleviates this better than setting tol.solve to a very small value</p></dd>

  <dt id="arg-llprof">llprof<a class="anchor" aria-label="anchor" href="#arg-llprof"></a></dt>
<dd><p>default NULL, can either be an integer, to divide the feasible ranges into a grid of points, or a two-column matrix of spatial coefficient values, at which to evaluate the likelihood function</p></dd>

  <dt id="arg-trs-trs-">trs1, trs2<a class="anchor" aria-label="anchor" href="#arg-trs-trs-"></a></dt>
<dd><p>default NULL, if given, vectors for each weights object of powered spatial weights matrix traces output by <code>trW</code>; when given, used in some Jacobian methods</p></dd>

  <dt id="arg-interval-interval-">interval1, interval2<a class="anchor" aria-label="anchor" href="#arg-interval-interval-"></a></dt>
<dd><p>default is NULL, search intervals for each weights object for autoregressive parameters</p></dd>

  <dt id="arg-trs">trs<a class="anchor" aria-label="anchor" href="#arg-trs"></a></dt>
<dd><p>default NULL, if given, a vector of powered spatial weights matrix traces output by <code>trW</code>; when given, insert the asymptotic analytical values into the numerical Hessian instead of the approximated values; may be used to get around some problems raised when the numerical Hessian is poorly conditioned, generating NaNs in subsequent operations; the use of trs is recommended</p></dd>

 <dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>list of extra control arguments - see section below</p></dd>

  <dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p><code>Sarlm</code> object from <code>lagsarlm</code>, <code>errorsarlm</code> or <code>sacsarlm</code></p></dd>

  <dt id="arg-correlation">correlation<a class="anchor" aria-label="anchor" href="#arg-correlation"></a></dt>
<dd><p>logical; if 'TRUE', the correlation matrix of the estimated parameters including sigma is returned and printed (default=FALSE)</p></dd>

  <dt id="arg-nagelkerke">Nagelkerke<a class="anchor" aria-label="anchor" href="#arg-nagelkerke"></a></dt>
<dd><p>if TRUE, the Nagelkerke pseudo R-squared is reported</p></dd>

  <dt id="arg-hausman">Hausman<a class="anchor" aria-label="anchor" href="#arg-hausman"></a></dt>
<dd><p>if TRUE, the results of the Hausman test for error models are reported</p></dd>

  <dt id="arg-adj-se">adj.se<a class="anchor" aria-label="anchor" href="#arg-adj-se"></a></dt>
<dd><p>if TRUE, adjust the coefficient standard errors for the number of fitted coefficients</p></dd>

  <dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code>Sarlm</code> object from <code>lagsarlm</code>, <code>errorsarlm</code> or <code>sacsarlm</code> in <code>print.Sarlm</code>, summary object from <code>summary.Sarlm</code> for
<code>print.summary.Sarlm</code></p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>the number of significant digits to use when printing</p></dd>

  <dt id="arg-signif-stars">signif.stars<a class="anchor" aria-label="anchor" href="#arg-signif-stars"></a></dt>
<dd><p>logical. If TRUE, "significance stars" are printed
          for each coefficient.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments passed to or from other methods</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The asymptotic standard error of \(\rho\) is only computed when
method=“eigen”, because the full matrix operations involved would be costly
for large n typically associated with the choice of method="spam" or "Matrix". The same applies to the coefficient covariance matrix. Taken as the
asymptotic matrix from the literature, it is typically badly scaled, and with the elements involving \(\rho\) (lag model) or \(\lambda\) (error model) being very small,
while other parts of the matrix can be very large (often many orders
of magnitude in difference). It often happens that the <code>tol.solve</code>
argument needs to be set to a smaller value than the default, or the RHS variables can be centred or reduced in range.</p>
<p>Versions of the package from 0.4-38 include numerical Hessian values where asymptotic standard errors are not available. This change has been introduced to permit the simulation of distributions for impact measures. The warnings made above with regard to variable scaling also apply in this case.</p>
<p>Note that the fitted() function for the output object assumes that the response
variable may be reconstructed as the sum of the trend, the signal, and the
noise (residuals). Since the values of the response variable are known,
their spatial lags are used to calculate signal components (Cressie 1993,
p. 564). This differs from other software, including GeoDa, which does not use
knowledge of the response variable in making predictions for the fitting data.
Refer to the help page of <code><a href="predict.sarlm.html">predict.Sarlm</a></code> for discussions and
references.</p>
<p>Because numerical optimisation is used to find the values of lambda and rho in <code>sacsarlm</code>, care needs to be shown. It has been found that the surface of the 2D likelihood function often forms a “banana trench” from (low rho, high lambda) through (high rho, high lambda) to (high rho, low lambda) values. In addition, sometimes the banana has optima towards both ends, one local, the other global, and conseqently the choice of the starting point for the final optimization becomes crucial. The default approach is not to use just (0, 0) as a starting point, nor the (rho, lambda) values from <code>gstsls</code>, which lie in a central part of the “trench”, but either four values at (low rho, high lambda), (0, 0), (high rho, high lambda), and (high rho, low lambda), and to use the best of these start points for the final optimization. Optionally, nine points can be used spanning the whole (lower, upper) space.</p>
    </div>
    <div class="section level2">
    <h2 id="control-arguments">Control arguments<a class="anchor" aria-label="anchor" href="#control-arguments"></a></h2>

<dl><dt>tol.opt:</dt>
<dd><p>the desired accuracy of the optimization - passed to <code><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">optimize()</a></code> (default=square root of double precision machine tolerance, a larger root may be used needed, see help(boston) for an example)</p></dd>

  <dt>returnHcov:</dt>
<dd><p>(error model) default TRUE, return the Vo matrix for a spatial Hausman test</p></dd>

  <dt>pWOrder:</dt>
<dd><p>(error model) default 250, if returnHcov=TRUE and the method is not “eigen”, pass this order to <code>powerWeights</code> as the power series maximum limit</p></dd>

  <dt>fdHess:</dt>
<dd><p>default NULL, then set to (method != "eigen") internally; use <code>fdHess</code> to compute an approximate Hessian using finite differences when using sparse matrix methods; used to make a coefficient covariance matrix when the number of observations is large; may be turned off to save resources if need be</p></dd>

  <dt>optimHess:</dt>
<dd><p>default FALSE, use <code>fdHess</code> from <span class="pkg">nlme</span>, if TRUE, use <code>optim</code> to calculate Hessian at optimum</p></dd>

  <dt>optimHessMethod:</dt>
<dd><p>default “optimHess”, may be “nlm” or one of the <code>optim</code> methods</p></dd>

  <dt>compiled_sse:</dt>
<dd><p>default FALSE; logical value used in the log likelihood function to choose compiled code for computing SSE</p></dd>

  <dt>Imult:</dt>
<dd><p>default 2; used for preparing the Cholesky decompositions for updating in the Jacobian function</p></dd>

  <dt>super:</dt>
<dd><p>if NULL (default), set to FALSE to use a simplicial decomposition for the sparse Cholesky decomposition and method “Matrix_J”, set to  <code>as.logical(NA)</code> for method “Matrix”, if TRUE, use a supernodal decomposition</p></dd>

  <dt>cheb_q:</dt>
<dd><p>default 5; highest power of the approximating polynomial for the Chebyshev approximation</p></dd>

  <dt>MC_p:</dt>
<dd><p>default 16; number of random variates</p></dd>

  <dt>MC_m:</dt>
<dd><p>default 30; number of products of random variates matrix and spatial weights matrix</p></dd>

  <dt>spamPivot:</dt>
<dd><p>default “MMD”, alternative “RCM”</p></dd>

  <dt>in_coef</dt>
<dd><p>default 0.1, coefficient value for initial Cholesky decomposition in “spam_update”</p></dd>

  <dt>type</dt>
<dd><p>default “MC”, used with method “moments”; alternatives “mult” and “moments”, for use if <code>trs</code> is missing, <code><a href="trW.html">trW</a></code></p></dd>

  <dt>correct</dt>
<dd><p>default TRUE, used with method “moments” to compute the Smirnov/Anselin correction term</p></dd>

  <dt>trunc</dt>
<dd><p>default TRUE, used with method “moments” to truncate the Smirnov/Anselin correction term</p></dd>

  <dt>SE_method</dt>
<dd><p>default “LU”, may be “MC”</p></dd>

  <dt>nrho</dt>
<dd><p>default 200, as in SE toolbox; the size of the first stage lndet grid; it may be reduced to for example 40</p></dd>

  <dt>interpn</dt>
<dd><p>default 2000, as in SE toolbox; the size of the second stage lndet grid</p></dd>

  <dt>small_asy</dt>
<dd><p>default TRUE; if the method is not “eigen”, use asymmetric covariances rather than numerical Hessian ones if n &lt;= small</p></dd>

  <dt>small</dt>
<dd><p>default 1500; threshold number of observations for asymmetric covariances when the method is not “eigen”</p></dd>

  <dt>SElndet</dt>
<dd><p>default NULL, may be used to pass a pre-computed SE toolbox style matrix of coefficients and their lndet values to the "SE_classic" and "SE_whichMin" methods</p></dd>

  <dt>LU_order</dt>
<dd><p>default FALSE; used in “LU_prepermutate”, note warnings given for <code>lu</code> method</p></dd>

  <dt>pre_eig</dt>
<dd><p>default NULL; may be used to pass a pre-computed vector of eigenvalues</p></dd>

  <dt>return_impacts</dt>
<dd><p>default TRUE; may be set FALSE to avoid problems calculating impacts with aliased variables</p></dd>

  <dt>OrdVsign</dt>
<dd><p>default 1; used to set the sign of the final component to negative if -1 (alpha times ((sigma squared) squared) in Ord (1975) equation B.1).</p></dd>

  <dt>opt_method:</dt>
<dd><p>default “nlminb”, may be set to “L-BFGS-B” to use box-constrained optimisation in <code>optim</code></p></dd>

  <dt>opt_control:</dt>
<dd><p>default <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>, a control list to pass to <code>nlminb</code> or <code>optim</code></p></dd>

  <dt>pars:</dt>
<dd><p>default <code>NULL</code>, for which five trial starting values spanning the lower/upper range are tried and the best selected, starting values of \(\rho\) and \(\lambda\)</p></dd>

  <dt>npars</dt>
<dd><p>default integer <code>4L</code>, four trial points; if not default value, nine trial points</p></dd>

  <dt>pre_eig1, pre_eig2</dt>
<dd><p>default NULL; may be used to pass pre-computed vectors of eigenvalues</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Cliff, A. D., Ord, J. K. 1981 <em>Spatial processes</em>, Pion;
Ord, J. K. 1975 Estimation methods for models of spatial interaction,
<em>Journal of the American Statistical Association</em>, 70, 120-126;
Anselin, L. 1988 <em>Spatial econometrics: methods and models.</em>
(Dordrecht: Kluwer); Anselin, L. 1995 SpaceStat, a software program for
the analysis of spatial data, version 1.80. Regional Research Institute,
West Virginia University, Morgantown, WV;
Anselin L, Bera AK (1998) Spatial dependence in linear regression models
with an introduction to spatial econometrics. In: Ullah A, Giles DEA
(eds) Handbook of applied economic statistics. Marcel Dekker, New York,
pp. 237-289; Nagelkerke NJD (1991) A note on a general definition of the
coefficient of determination. Biometrika 78: 691-692; Cressie, N. A. C. 1993 <em>Statistics for spatial data</em>, Wiley, New York; LeSage J and RK Pace (2009) Introduction to Spatial Econometrics. CRC Press, Boca Raton.</p>
<p>Roger Bivand, Gianfranco Piras (2015). Comparing Implementations of Estimation Methods for Spatial Econometrics. <em>Journal of Statistical Software</em>, 63(18), 1-36. <a href="https://doi.org/10.18637/jss.v063.i18" class="external-link">doi:10.18637/jss.v063.i18</a>
.</p>
<p>Bivand, R. S., Hauke, J., and Kossowski, T. (2013). Computing the Jacobian in Gaussian spatial autoregressive models: An illustrated comparison of available methods. <em>Geographical Analysis</em>, 45(2), 150-179.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a>, with thanks to Andrew
Bernat for contributions to the asymptotic standard error code.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>, <code><a href="impacts.html">impacts</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">oldcol</span>, package<span class="op">=</span><span class="st">"spdep"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span>, style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="eigenw.html">eigenw</a></span><span class="op">(</span><span class="va">listw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">listw</span>, <span class="st">"CsparseMatrix"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trMatc</span> <span class="op">&lt;-</span> <span class="fu"><a href="trW.html">trW</a></span><span class="op">(</span><span class="va">W</span>, type<span class="op">=</span><span class="st">"mult"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eig</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">listw</span>,</span></span>
<span class="r-in"><span> method<span class="op">=</span><span class="st">"eigen"</span>, quiet<span class="op">=</span><span class="cn">FALSE</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span>, OrdVsign<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial lag model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jacobian calculated using neighbourhood matrix eigenvalues</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 -0.5674437 	function value:	 -202.2909 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.03126655 	function value:	 -186.749 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4012898 	function value:	 -182.419 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.6138418 	function value:	 -183.5636 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4157662 	function value:	 -182.398 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4295565 	function value:	 -182.3905 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4311288 	function value:	 -182.3904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4310273 	function value:	 -182.3904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4310232 	function value:	 -182.3904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4310232 	function value:	 -182.3904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4310232 	function value:	 -182.3904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4310232 	function value:	 -182.3904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4310232 	function value:	 -182.3904 </span>
<span class="r-in"><span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.lag.eig</span>, correlation<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:lagsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     method = "eigen", quiet = FALSE, control = list(pre_eig = ev, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         OrdVsign = 1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -37.68585  -5.35636   0.05421   6.02013  23.20555 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: lag </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (asymptotic standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 45.079249   7.177346  6.2808 3.369e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -1.031616   0.305143 -3.3808 0.0007229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.265926   0.088499 -3.0049 0.0026570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rho: 0.43102, LR test value: 9.9736, p-value: 0.001588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 0.11768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 3.6626, p-value: 0.00024962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald statistic: 13.415, p-value: 0.00024962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -182.3904 for lag model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 95.494, (sigma: 9.7721)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 374.78, (AIC for lm: 382.75)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LM test for residual autocorrelation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test value: 0.31954, p-value: 0.57188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Correlation of coefficients </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             sigma rho   (Intercept) INC  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho         -0.14                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  0.12 -0.83                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -0.05  0.35 -0.61            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.01  0.08 -0.25       -0.44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Std. Error   z value     Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 45.0792493 7.17734647  6.280768 3.369043e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -1.0316157 0.30514297 -3.380762 7.228519e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.2659263 0.08849862 -3.004863 2.657002e-03</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eig</span><span class="op">$</span><span class="va">fdHess</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eig</span><span class="op">$</span><span class="va">resvar</span></span></span>
<span class="r-in"><span><span class="co"># using the apparent sign in Ord (1975, equation B.1) </span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eigb</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">listw</span>,</span></span>
<span class="r-in"><span> method<span class="op">=</span><span class="st">"eigen"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span>, OrdVsign<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.lag.eigb</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eigb</span><span class="op">$</span><span class="va">fdHess</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eigb</span><span class="op">$</span><span class="va">resvar</span></span></span>
<span class="r-in"><span><span class="co"># force numerical Hessian</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eig1</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> listw<span class="op">=</span><span class="va">listw</span>, method<span class="op">=</span><span class="st">"Matrix"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>small<span class="op">=</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.lag.eig1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eig1</span><span class="op">$</span><span class="va">fdHess</span></span></span>
<span class="r-in"><span><span class="co"># force LeSage &amp; Pace (2008, p. 57) approximation </span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eig1a</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> listw<span class="op">=</span><span class="va">listw</span>, method<span class="op">=</span><span class="st">"Matrix"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>small<span class="op">=</span><span class="fl">25</span><span class="op">)</span>, trs<span class="op">=</span><span class="va">trMatc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.lag.eig1a</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eig1a</span><span class="op">$</span><span class="va">fdHess</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eig</span><span class="op">$</span><span class="va">resvar</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># using the apparent sign in Ord (1975, equation B.1) </span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eigb</span><span class="op">$</span><span class="va">resvar</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># force numerical Hessian</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eig1</span><span class="op">$</span><span class="va">fdHess</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># force LeSage &amp; Pace (2008, p. 57) approximation </span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eig1a</span><span class="op">$</span><span class="va">fdHess</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">COL.lag.M</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, method<span class="op">=</span><span class="st">"Matrix"</span>, quiet<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial lag model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jacobian calculated using sparse matrix Cholesky decomposition</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 -0.2364499 	function value:	 -192.9523 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.2354499 	function value:	 -183.542 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.5271001 	function value:	 -182.7039 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4455543 	function value:	 -182.3974 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4267907 	function value:	 -182.391 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4311986 	function value:	 -182.3904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4310114 	function value:	 -182.3904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4310231 	function value:	 -182.3904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4310232 	function value:	 -182.3904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4310232 	function value:	 -182.3904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4310232 	function value:	 -182.3904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho:	 0.4310232 	function value:	 -182.3904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing eigenvalues ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.163   0.001   0.166 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.lag.M</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:lagsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     method = "Matrix", quiet = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -37.68585  -5.35636   0.05421   6.02013  23.20555 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: lag </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (asymptotic standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 45.079249   7.177346  6.2808 3.369e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -1.031616   0.305143 -3.3808 0.0007229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.265926   0.088499 -3.0049 0.0026570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rho: 0.43102, LR test value: 9.9736, p-value: 0.001588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 0.11768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 3.6626, p-value: 0.00024962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald statistic: 13.415, p-value: 0.00024962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -182.3904 for lag model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 95.494, (sigma: 9.7721)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 374.78, (AIC for lm: 382.75)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LM test for residual autocorrelation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test value: 0.31954, p-value: 0.57188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">COL.lag.M</span>, listw<span class="op">=</span><span class="va">listw</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Impact measures (lag, exact):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Direct   Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   -1.0860220 -0.7270848 -1.8131068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL -0.2799509 -0.1874254 -0.4673763</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">COL.lag.sp</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> listw<span class="op">=</span><span class="va">listw</span>, method<span class="op">=</span><span class="st">"spam"</span>, quiet<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.lag.sp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.B</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.lag.B</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.mixed.B</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"mixed"</span>, tol.solve<span class="op">=</span><span class="fl">1e-9</span>,</span></span>
<span class="r-in"><span> control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.mixed.B</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.mixed.W</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, type<span class="op">=</span><span class="st">"mixed"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.mixed.W</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.mixed.D00</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, Durbin<span class="op">=</span><span class="cn">TRUE</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.mixed.D00</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.mixed.D01</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, Durbin<span class="op">=</span><span class="cn">FALSE</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.mixed.D01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.mixed.D1</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, Durbin<span class="op">=</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.mixed.D1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span></span></span>
<span class="r-in"><span><span class="va">COL.mixed.D2</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">f</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, <span class="va">listw</span>,</span></span>
<span class="r-in"><span> Durbin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/delete.response.html" class="external-link">delete.response</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/terms.html" class="external-link">terms</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.mixed.D2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.mixed.D1a</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, Durbin<span class="op">=</span> <span class="op">~</span> <span class="va">INC</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.mixed.D1a</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="va">COL.mixed.D1</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, Durbin<span class="op">=</span> <span class="op">~</span> <span class="va">inc</span> <span class="op">+</span> <span class="va">HOVAL</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="va">COL.mixed.D1</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, Durbin<span class="op">=</span> <span class="op">~</span> <span class="va">DISCBD</span> <span class="op">+</span> <span class="va">HOVAL</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">NA.COL.OLD</span> <span class="op">&lt;-</span> <span class="va">COL.OLD</span></span></span>
<span class="r-in"><span><span class="va">NA.COL.OLD</span><span class="op">$</span><span class="va">CRIME</span><span class="op">[</span><span class="fl">20</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.NA</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">NA.COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, na.action<span class="op">=</span><span class="va">na.exclude</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.NA</span><span class="op">$</span><span class="va">na.action</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.NA</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">COL.lag.NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.NA1</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">NA.COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, Durbin<span class="op">=</span><span class="op">~</span><span class="va">INC</span><span class="op">)</span> <span class="co"># https://github.com/r-spatial/spatialreg/issues/10</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.NA1</span><span class="op">$</span><span class="va">na.action</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.NA2</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">NA.COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, Durbin<span class="op">=</span><span class="op">~</span><span class="va">INC</span>, na.action<span class="op">=</span><span class="va">na.exclude</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.NA2</span><span class="op">$</span><span class="va">na.action</span></span></span>
<span class="r-in"><span><span class="co"># https://github.com/r-spatial/spatialreg/issues/11</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.NA3</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">NA.COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.NA3</span><span class="op">$</span><span class="va">na.action</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">boston</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gp2mM</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">CMEDV</span><span class="op">)</span> <span class="op">~</span> <span class="va">CRIM</span> <span class="op">+</span> <span class="va">ZN</span> <span class="op">+</span> <span class="va">INDUS</span> <span class="op">+</span> <span class="va">CHAS</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">NOX</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">RM</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>  <span class="va">AGE</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">DIS</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">RAD</span><span class="op">)</span> <span class="op">+</span> <span class="va">TAX</span> <span class="op">+</span> <span class="va">PTRATIO</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">LSTAT</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>data<span class="op">=</span><span class="va">boston.c</span>, <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">boston.soi</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"mixed"</span>, method<span class="op">=</span><span class="st">"Matrix"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gp2mM</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">boston.soi</span><span class="op">)</span>, <span class="st">"CsparseMatrix"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trMatb</span> <span class="op">&lt;-</span> <span class="fu"><a href="trW.html">trW</a></span><span class="op">(</span><span class="va">W</span>, type<span class="op">=</span><span class="st">"mult"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gp2mMi</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">CMEDV</span><span class="op">)</span> <span class="op">~</span> <span class="va">CRIM</span> <span class="op">+</span> <span class="va">ZN</span> <span class="op">+</span> <span class="va">INDUS</span> <span class="op">+</span> <span class="va">CHAS</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">NOX</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">RM</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>  <span class="va">AGE</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">DIS</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">RAD</span><span class="op">)</span> <span class="op">+</span> <span class="va">TAX</span> <span class="op">+</span> <span class="va">PTRATIO</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">LSTAT</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>data<span class="op">=</span><span class="va">boston.c</span>, <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">boston.soi</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"mixed"</span>, method<span class="op">=</span><span class="st">"Matrix"</span>, </span></span>
<span class="r-in"><span>trs<span class="op">=</span><span class="va">trMatb</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gp2mMi</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, quiet<span class="op">=</span><span class="cn">FALSE</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial autoregressive error model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jacobian calculated using neighbourhood matrix eigenvalues</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: -0.5674437  function: -195.8051  Jacobian: -1.636549  SSE: 7936.201 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.03126655  function: -187.0219  Jacobian: -0.005318373  SSE: 5927.009 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.4012898  function: -183.8422  Jacobian: -0.9953987  SSE: 4999.419 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.6299767  function: -183.4895  Jacobian: -2.818134  SSE: 4574.641 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5811116  function: -183.3887  Jacobian: -2.314073  SSE: 4650.566 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.554104  function: -183.3817  Jacobian: -2.066354  SSE: 4696.49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5621834  function: -183.3805  Jacobian: -2.138326  SSE: 4682.474 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5617028  function: -183.3805  Jacobian: -2.133995  SSE: 4683.301 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5617888  function: -183.3805  Jacobian: -2.134769  SSE: 4683.153 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5617902  function: -183.3805  Jacobian: -2.134782  SSE: 4683.151 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5617903  function: -183.3805  Jacobian: -2.134782  SSE: 4683.151 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5617902  function: -183.3805  Jacobian: -2.134782  SSE: 4683.151 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5617902  function: -183.3805  Jacobian: -2.134782  SSE: 4683.151 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:errorsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     quiet = FALSE, control = list(pre_eig = ev))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -34.81174  -6.44031  -0.72142   7.61476  23.33626 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: error </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (asymptotic standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 59.893220   5.366162 11.1613 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -0.941312   0.330569 -2.8476 0.0044057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.302250   0.090476 -3.3407 0.0008358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.56179, LR test value: 7.9935, p-value: 0.0046945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 0.13387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 4.1966, p-value: 2.7098e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald statistic: 17.611, p-value: 2.7098e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -183.3805 for error model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 95.575, (sigma: 9.7762)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 376.76, (AIC for lm: 382.75)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">COL.errW.eig_ev</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">COL.errW.eig_ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="va">COL.errB.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.errB.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> errorsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = spdep::nb2listw(COL.nb, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     style = "B"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -32.19010  -5.22646  -0.69952   7.92588  24.23511 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: error </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (asymptotic standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 55.383119   5.449775 10.1625 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -0.936595   0.319355 -2.9328 0.0033596</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.299857   0.088678 -3.3814 0.0007212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.12686, LR test value: 10.654, p-value: 0.0010983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 0.021745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 5.8342, p-value: 5.4044e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald statistic: 34.038, p-value: 5.4044e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -182.0502 for error model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 88.744, (sigma: 9.4204)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 374.1, (AIC for lm: 382.75)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">COL.errW.M</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, method<span class="op">=</span><span class="st">"Matrix"</span>, quiet<span class="op">=</span><span class="cn">FALSE</span>, trs<span class="op">=</span><span class="va">trMatc</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial autoregressive error model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Jacobian calculated using sparse matrix Cholesky decomposition</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: -0.2364499  function: -190.4287  Jacobian: -0.2899343  SSE: 6732.556 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.2354499  function: -185.0024  Jacobian: -0.3201148  SSE: 5388.346 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5271001  function: -183.4053  Jacobian: -1.838306  SSE: 4744.975 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.728364  function: -184.1244  Jacobian: -4.106761  SSE: 4454.203 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5304163  function: -183.4009  Jacobian: -1.865308  SSE: 4738.889 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5557478  function: -183.3812  Jacobian: -2.080853  SSE: 4693.62 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.6216813  function: -183.4637  Jacobian: -2.727084  SSE: 4586.84 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5627129  function: -183.3805  Jacobian: -2.143105  SSE: 4681.563 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5618852  function: -183.3805  Jacobian: -2.135638  SSE: 4682.987 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5617866  function: -183.3805  Jacobian: -2.134749  SSE: 4683.157 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5617903  function: -183.3805  Jacobian: -2.134783  SSE: 4683.15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5617903  function: -183.3805  Jacobian: -2.134782  SSE: 4683.151 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5617903  function: -183.3805  Jacobian: -2.134782  SSE: 4683.151 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5617903  function: -183.3805  Jacobian: -2.134783  SSE: 4683.151 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5617903  function: -183.3805  Jacobian: -2.134783  SSE: 4683.151 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 0.5617903  function: -183.3805  Jacobian: -2.134783  SSE: 4683.151 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.errW.M</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:errorsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     method = "Matrix", quiet = FALSE, trs = trMatc)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -34.81174  -6.44031  -0.72142   7.61476  23.33626 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: error </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (asymptotic standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 59.893219   5.366163 11.1613 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -0.941312   0.330569 -2.8476 0.0044057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.302250   0.090476 -3.3407 0.0008358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.56179, LR test value: 7.9935, p-value: 0.0046945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 0.13387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 4.1966, p-value: 2.7098e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald statistic: 17.611, p-value: 2.7098e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -183.3805 for error model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 95.575, (sigma: 9.7762)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 376.76, (AIC for lm: 382.75)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">COL.SDEM.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, etype<span class="op">=</span><span class="st">"emixed"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.SDEM.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:errorsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     etype = "emixed", control = list(pre_eig = ev))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -37.31635  -6.54376  -0.22212   6.44591  23.15801 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: error </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (asymptotic standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 73.545133   8.783543  8.3731 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -1.051673   0.319514 -3.2915 0.0009966</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.275608   0.091151 -3.0236 0.0024976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.INC     -1.156711   0.578629 -1.9991 0.0456024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.HOVAL    0.111691   0.198993  0.5613 0.5746048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.4254, LR test value: 4.9871, p-value: 0.025537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 0.15842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 2.6852, p-value: 0.0072485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald statistic: 7.2103, p-value: 0.0072485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -181.5846 for error model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 92.531, (sigma: 9.6193)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 377.17, (AIC for lm: 380.16)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">COL.SDEM.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, Durbin<span class="op">=</span><span class="cn">TRUE</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.SDEM.eig</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.SDEM.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">DISCBD</span> <span class="op">+</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, Durbin<span class="op">=</span><span class="op">~</span><span class="va">INC</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.SDEM.eig</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">COL.SDEM.eig</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">NA.COL.OLD</span> <span class="op">&lt;-</span> <span class="va">COL.OLD</span></span></span>
<span class="r-in"><span><span class="va">NA.COL.OLD</span><span class="op">$</span><span class="va">CRIME</span><span class="op">[</span><span class="fl">20</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">COL.err.NA</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">NA.COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, na.action<span class="op">=</span><span class="va">na.exclude</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.err.NA</span><span class="op">$</span><span class="va">na.action</span></span></span>
<span class="r-in"><span><span class="va">COL.err.NA</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">COL.err.NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="eigenw.html">eigenw</a></span><span class="op">(</span><span class="fu"><a href="similar.listw.html">similar.listw</a></span><span class="op">(</span><span class="va">listw</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, method<span class="op">=</span><span class="st">"eigen"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ocoef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, method<span class="op">=</span><span class="st">"eigen"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span>, LAPACK<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">ocoef</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, method<span class="op">=</span><span class="st">"eigen"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig<span class="op">=</span><span class="va">ev</span>, compiled_sse<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">ocoef</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, method<span class="op">=</span><span class="st">"Matrix_J"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>super<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">ocoef</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, method<span class="op">=</span><span class="st">"Matrix_J"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>super<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">ocoef</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, method<span class="op">=</span><span class="st">"Matrix_J"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>super<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">ocoef</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, method<span class="op">=</span><span class="st">"Matrix"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>super<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">ocoef</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, method<span class="op">=</span><span class="st">"Matrix"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>super<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">ocoef</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, method<span class="op">=</span><span class="st">"Matrix"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>super<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">ocoef</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, method<span class="op">=</span><span class="st">"spam"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>spamPivot<span class="op">=</span><span class="st">"MMD"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">ocoef</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, method<span class="op">=</span><span class="st">"spam"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>spamPivot<span class="op">=</span><span class="st">"RCM"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">ocoef</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, method<span class="op">=</span><span class="st">"spam_update"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>spamPivot<span class="op">=</span><span class="st">"MMD"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">ocoef</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, method<span class="op">=</span><span class="st">"spam_update"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>spamPivot<span class="op">=</span><span class="st">"RCM"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">ocoef</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">COL.errW.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="va">COL.sacW.eig</span> <span class="op">&lt;-</span> <span class="fu">sacsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, <span class="va">listw</span>,</span></span>
<span class="r-in"><span> control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig1<span class="op">=</span><span class="va">ev</span>, pre_eig2<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.sacW.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:sacsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     control = list(pre_eig1 = ev, pre_eig2 = ev))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -37.32081  -5.33662  -0.20219   6.59672  23.25604 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: sac </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (asymptotic standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 47.783764   9.902659  4.8253 1.398e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -1.025894   0.326326 -3.1438  0.001668</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.281651   0.090033 -3.1283  0.001758</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rho: 0.36807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 0.19668</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 1.8714, p-value: 0.061285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.16668</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 0.29661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 0.56196, p-value: 0.57415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LR test value: 10.285, p-value: 0.0058432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -182.2348 for sac model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 95.604, (sigma: 9.7777)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 376.47, (AIC for lm: 382.75)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">COL.sacW.eig</span>, tr<span class="op">=</span><span class="va">trMatc</span>, R<span class="op">=</span><span class="fl">2000</span><span class="op">)</span>, zstats<span class="op">=</span><span class="cn">TRUE</span>, short<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Impact measures (sac, trace):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Direct   Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   -1.0632723 -0.5601502 -1.6234225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL -0.2919129 -0.1537848 -0.4456977</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulation results ( variance matrix):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated standard errors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Direct  Indirect     Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   0.3200735 0.8453130 0.9606199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL 0.0947660 0.2823186 0.3278763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated z-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Direct   Indirect     Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   -3.376570 -0.8371025 -1.861677</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL -3.159909 -0.7431010 -1.553156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated p-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Direct     Indirect Total   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   0.00073396 0.40253  0.062649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL 0.00157819 0.45742  0.120386</span>
<span class="r-in"><span><span class="va">COL.msacW.eig</span> <span class="op">&lt;-</span> <span class="fu">sacsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, <span class="va">listw</span>,</span></span>
<span class="r-in"><span> type<span class="op">=</span><span class="st">"sacmixed"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig1<span class="op">=</span><span class="va">ev</span>, pre_eig2<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.msacW.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:sacsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     type = "sacmixed", control = list(pre_eig1 = ev, pre_eig2 = ev))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -37.8045  -6.5244  -0.2207   5.9944  22.8691 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: sacmixed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (asymptotic standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 50.92026   68.25721  0.7460 0.455664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -0.95072    0.44033 -2.1591 0.030841</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.28650    0.09994 -2.8667 0.004148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.INC     -0.69261    1.69113 -0.4096 0.682132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.HOVAL    0.20852    0.28702  0.7265 0.467546</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rho: 0.31557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 0.9458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 0.33365, p-value: 0.73864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.15415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 1.0643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 0.14484, p-value: 0.88484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LR test value: 12.07, p-value: 0.016837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -181.3422 for sacmixed model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 93.149, (sigma: 9.6514)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 378.68, (AIC for lm: 382.75)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">COL.msacW.eig</span>, tr<span class="op">=</span><span class="va">trMatc</span>, R<span class="op">=</span><span class="fl">2000</span><span class="op">)</span>, zstats<span class="op">=</span><span class="cn">TRUE</span>, short<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Impact measures (sacmixed, trace):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Direct   Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   -1.0317003 -1.3693141 -2.4010144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL -0.2768608  0.1629265 -0.1139344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulation results ( variance matrix):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated standard errors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Direct  Indirect     Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   0.3778064 2.1709289 2.3099448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL 0.1144714 0.7736216 0.8389226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated z-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Direct   Indirect       Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   -2.737182 -0.7297008 -1.13347010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL -2.364129  0.2526689 -0.08958505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated p-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Direct    Indirect Total  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   0.0061968 0.46557  0.25702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL 0.0180725 0.80052  0.92862</span>
<span class="r-in"><span><span class="va">COL.msacW1.eig</span> <span class="op">&lt;-</span> <span class="fu">sacsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, <span class="va">listw</span>,</span></span>
<span class="r-in"><span> Durbin<span class="op">=</span><span class="cn">TRUE</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig1<span class="op">=</span><span class="va">ev</span>, pre_eig2<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.msacW1.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:sacsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Durbin = TRUE, control = list(pre_eig1 = ev, pre_eig2 = ev))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -37.8045  -6.5244  -0.2207   5.9944  22.8691 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: sacmixed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (asymptotic standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 50.92026   68.25721  0.7460 0.455664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -0.95072    0.44033 -2.1591 0.030841</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.28650    0.09994 -2.8667 0.004148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.INC     -0.69261    1.69113 -0.4096 0.682132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.HOVAL    0.20852    0.28702  0.7265 0.467546</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rho: 0.31557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 0.9458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 0.33365, p-value: 0.73864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.15415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 1.0643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 0.14484, p-value: 0.88484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LR test value: 12.07, p-value: 0.016837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -181.3422 for sacmixed model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 93.149, (sigma: 9.6514)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 378.68, (AIC for lm: 382.75)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">COL.msacW1.eig</span>, tr<span class="op">=</span><span class="va">trMatc</span>, R<span class="op">=</span><span class="fl">2000</span><span class="op">)</span>, zstats<span class="op">=</span><span class="cn">TRUE</span>, short<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Impact measures (sacmixed, trace):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Direct   Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   -1.0317003 -1.3693141 -2.4010144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL -0.2768608  0.1629265 -0.1139344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulation results ( variance matrix):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated standard errors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Direct  Indirect     Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   0.3778064 2.1709289 2.3099448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL 0.1144714 0.7736216 0.8389226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated z-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Direct   Indirect       Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   -2.737182 -0.7297008 -1.13347010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL -2.364129  0.2526689 -0.08958505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated p-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Direct    Indirect Total  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   0.0061968 0.46557  0.25702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL 0.0180725 0.80052  0.92862</span>
<span class="r-in"><span><span class="va">COL.msacW2.eig</span> <span class="op">&lt;-</span> <span class="fu">sacsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">DISCBD</span> <span class="op">+</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, </span></span>
<span class="r-in"><span> <span class="va">listw</span>, Durbin<span class="op">=</span> <span class="op">~</span> <span class="va">INC</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pre_eig1<span class="op">=</span><span class="va">ev</span>, pre_eig2<span class="op">=</span><span class="va">ev</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.msacW2.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:sacsarlm(formula = CRIME ~ DISCBD + INC + HOVAL, data = COL.OLD, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     listw = listw, Durbin = ~INC, control = list(pre_eig1 = ev, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         pre_eig2 = ev))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -34.2794  -7.0786   1.0543   6.0019  17.8891 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: sacmixed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (asymptotic standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 74.064502  37.738940  1.9625 0.049699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DISCBD      -5.707678   3.248629 -1.7569 0.078926</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -0.900975   0.314996 -2.8603 0.004233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.203399   0.092982 -2.1875 0.028705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.INC      0.061568   0.926947  0.0664 0.947043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rho: -0.077599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 0.57955</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: -0.1339, p-value: 0.89348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.29646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 0.51021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 0.58104, p-value: 0.56121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LR test value: 1.4982, p-value: 0.68269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -178.963 for sacmixed model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 85.135, (sigma: 9.2269)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 373.93, (AIC for lm: 369.42)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">COL.msacW2.eig</span>, tr<span class="op">=</span><span class="va">trMatc</span>, R<span class="op">=</span><span class="fl">2000</span><span class="op">)</span>, zstats<span class="op">=</span><span class="cn">TRUE</span>, short<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Impact measures (sacmixed, trace):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Direct   Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DISCBD -5.7150799 0.41841671 -5.2966632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC    -0.9031729 0.12421198 -0.7789609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL  -0.2036631 0.01491074 -0.1887524</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulation results ( variance matrix):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated standard errors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Direct  Indirect    Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DISCBD 3.1446963 5.7201656 5.757459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC    0.3621137 1.7150155 1.876353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL  0.1090172 0.6360488 0.698836</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated z-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Direct   Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DISCBD -1.852002  0.0280018 -0.9837341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC    -2.461864  0.1861184 -0.3049951</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL  -2.021743 -0.1841543 -0.4829973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated p-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Direct   Indirect Total  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DISCBD 0.064026 0.97766  0.32525</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC    0.013822 0.85235  0.76037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL  0.043203 0.85389  0.62910</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">COL.mix.eig</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, type<span class="op">=</span><span class="st">"mixed"</span>, method<span class="op">=</span><span class="st">"eigen"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.mix.eig</span>, correlation<span class="op">=</span><span class="cn">TRUE</span>, Nagelkerke<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.mix.M</span> <span class="op">&lt;-</span> <span class="fu">lagsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="va">listw</span>, type<span class="op">=</span><span class="st">"mixed"</span>, method<span class="op">=</span><span class="st">"Matrix"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.mix.M</span>, correlation<span class="op">=</span><span class="cn">TRUE</span>, Nagelkerke<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu">errorsarlm</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span>  <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span>, style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"eigen"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.errW.eig</span>, correlation<span class="op">=</span><span class="cn">TRUE</span>, Nagelkerke<span class="op">=</span><span class="cn">TRUE</span>, Hausman<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Roger Bivand, Gianfranco Piras.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

