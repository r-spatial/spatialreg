<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Likelihood ratio test — LR.sarlm • spatialreg</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Likelihood ratio test — LR.sarlm" />

<meta property="og:description" content="The LR.sarlm() function provides a likelihood ratio test for objects for which a logLik() function exists for their class, or for objects of class logLik. LR1.sarlm() and Wald1.sarlm() are used internally in summary.sarlm(), but may be accessed directly; they report the values respectively of LR and Wald tests for the absence of spatial dependence in spatial lag or error models. The spatial Hausman test is available for models fitted with errorsarlm and GMerrorsar." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spatialreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/SpatialFiltering.html">Moran Eigenvectors</a>
    </li>
    <li>
      <a href="../articles/sids_models.html">North Carolina SIDS data set (models)</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-spatial/spatialreg">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Likelihood ratio test</h1>
    
    <div class="hidden name"><code>sarlm_tests.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The <code>LR.sarlm()</code> function provides a likelihood ratio test for objects for which a <code><a href='https://www.rdocumentation.org/packages/stats/topics/logLik'>logLik()</a></code> function exists for their class, or for objects of class <code>logLik</code>. <code>LR1.sarlm()</code> and <code>Wald1.sarlm()</code> are used internally in <code><a href='ML_models.html'>summary.sarlm()</a></code>, but may be accessed directly; they report the values respectively of LR and Wald tests for the absence of spatial dependence in spatial lag or error models. The spatial Hausman test is available for models fitted with <code>errorsarlm</code> and <code>GMerrorsar</code>.</p>
    
    </div>

    <pre class="usage">LR.sarlm(x, y)
# S3 method for sarlm
logLik(object, ...)
LR1.sarlm(object)
Wald1.sarlm(object)
# S3 method for sarlm
Hausman.test(object, ..., tol=NULL)
# S3 method for sarlm
anova(object, ...)
bptest.sarlm(object, varformula=NULL, studentize = TRUE, data=list())
# S3 method for sarlm
impacts(obj, &#8230;, tr, R = NULL, listw = NULL, evalues=NULL,
 useHESS = NULL, tol = 1e-06, empirical = FALSE, Q=NULL)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a <code>logLik</code> object or an object for which a <code><a href='https://www.rdocumentation.org/packages/stats/topics/logLik'>logLik()</a></code> function exists</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>a <code>logLik</code> object or an object for which a <code><a href='https://www.rdocumentation.org/packages/stats/topics/logLik'>logLik()</a></code> function exists</p></td>
    </tr>
    <tr>
      <th>object, obj</th>
      <td><p>a <code>sarlm</code> object</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>further arguments passed to or from other methods</p></td>
    </tr>
    <tr>
      <th>varformula</th>
      <td><p>a formula describing only the potential explanatory variables for the variance (no dependent variable needed). By default the same explanatory variables are taken as in the main regression model</p></td>
    </tr>
    <tr>
      <th>studentize</th>
      <td><p>logical. If set to <code>TRUE</code> Koenker's studentized
   version of the test statistic will be used.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>an optional data frame containing the variables in the varformula</p></td>
    </tr>
    <tr>
      <th>tr</th>
      <td><p>A vector of traces of powers of the spatial weights matrix created using <code>trW</code>, for approximate impact measures; if not given, <code>listw</code> must be given for exact measures (for small to moderate spatial weights matrices); the traces must be for the same spatial weights as were used in fitting the spatial regression, and must be row-standardised</p></td>
    </tr>
    <tr>
      <th>listw</th>
      <td><p>If <code>tr</code> is not given, a spatial weights object as created by <code>nb2listw</code>; they must be the same spatial weights as were used in fitting the spatial regression, but do not have to be row-standardised</p></td>
    </tr>
    <tr>
      <th>evalues</th>
      <td><p>vector of eigenvalues of spatial weights matrix for impacts calculations</p></td>
    </tr>
    <tr>
      <th>R</th>
      <td><p>If given, simulations are used to compute distributions for the impact measures, returned as <code>mcmc</code> objects; the objects are used for convenience but are not output by an MCMC process</p></td>
    </tr>
    <tr>
      <th>useHESS</th>
      <td><p>Use the Hessian approximation (if available) even if the asymptotic coefficient covariance matrix is available; used for comparing methods</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Argument passed to <code>mvrnorm</code> and <code>solve</code>: tolerance (relative to largest variance) for numerical lack of positive-definiteness in the coefficient covariance matrix</p></td>
    </tr>
    <tr>
      <th>empirical</th>
      <td><p>Argument passed to <code>mvrnorm</code> (default FALSE): if true, the coefficients and their covariance matrix specify the empirical not population mean and covariance matrix</p></td>
    </tr>
    <tr>
      <th>Q</th>
      <td><p>default NULL, else an integer number of cumulative power series impacts to calculate if <code>tr</code> is given</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The tests return objects of class <code>htest</code> with:</p>
<dt>statistic</dt><dd><p>value of statistic</p></dd>
  <dt>parameter</dt><dd><p>degrees of freedom</p></dd>
  <dt>p.value</dt><dd><p>Probability value</p></dd>
  <dt>estimate</dt><dd><p>varies with test</p></dd>
  <dt>method</dt><dd><p>description of test method</p></dd>

  logLik.sarlm() returns an object of class logLik
  LR1.sarlm, Hausman.sarlm and Wald1.sarlm returm objects of class htest

    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The numbers of degrees of freedom returned by <code>logLik.sarlm()</code> include nuisance parameters, that is the number of regression coefficients, plus sigma, plus spatial parameter esitmate(s).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>LeSage J and RK Pace (2009) Introduction to Spatial Econometrics. CRC Press, Boca Raton, pp. 61--63; Pace RK and LeSage J (2008) A spatial Hausman test. <em>Economics Letters</em> 101, 282--284.
T.S. Breusch &amp; A.R. Pagan (1979),
A Simple Test for Heteroscedasticity and Random Coefficient Variation.
<em>Econometrica</em> <b>47</b>, 1287--1294</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model under Test</em>. Heidelberg: Physica.</p>
<p>L. Anselin (1988) <em>Spatial econometrics: methods and models.</em>
Dordrecht: Kluwer, pp. 121--122.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://www.rdocumentation.org/packages/stats/topics/logLik'>logLik.lm</a></code>, <code>anova.sarlm</code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='st'>"sf"</span>, <span class='kw'>quietly</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>columbus</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/sf/topics/st_read'>st_read</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"shapes/columbus.shp"</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"spData"</span>)[<span class='fl'>1</span>], <span class='kw'>quiet</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='co'>#require("spdep", quietly=TRUE)</span>
<span class='no'>col.gal.nb</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>spdep</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/spdep/topics/read.gal'>read.gal</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"weights/columbus.gal"</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"spData"</span>)[<span class='fl'>1</span>])
<span class='no'>lm.mod</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/lm'>lm</a></span>(<span class='no'>CRIME</span> ~ <span class='no'>HOVAL</span> + <span class='no'>INC</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>columbus</span>)
<span class='no'>lag</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='ML_models.html'>lagsarlm</a></span>(<span class='no'>CRIME</span> ~ <span class='no'>HOVAL</span> + <span class='no'>INC</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>columbus</span>, <span class='kw pkg'>spdep</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/spdep/topics/nb2listw'>nb2listw</a></span>(<span class='no'>col.gal.nb</span>))
<span class='no'>mixed</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='ML_models.html'>lagsarlm</a></span>(<span class='no'>CRIME</span> ~ <span class='no'>HOVAL</span> + <span class='no'>INC</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>columbus</span>, <span class='kw pkg'>spdep</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/spdep/topics/nb2listw'>nb2listw</a></span>(<span class='no'>col.gal.nb</span>), <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"mixed"</span>)
<span class='no'>error</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='ML_models.html'>errorsarlm</a></span>(<span class='no'>CRIME</span> ~ <span class='no'>HOVAL</span> + <span class='no'>INC</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>columbus</span>, <span class='kw pkg'>spdep</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/spdep/topics/nb2listw'>nb2listw</a></span>(<span class='no'>col.gal.nb</span>))
<span class='fu'>Hausman.test</span>(<span class='no'>error</span>)</div><div class='output co'>#&gt; 
#&gt; 	Spatial Hausman test (asymptotic)
#&gt; 
#&gt; data:  NULL
#&gt; Hausman test = 6.4729, df = 3, p-value = 0.09074
#&gt; </div><div class='input'><span class='fu'>LR.sarlm</span>(<span class='no'>mixed</span>, <span class='no'>error</span>)</div><div class='output co'>#&gt; 
#&gt; 	Likelihood ratio for spatial linear models
#&gt; 
#&gt; data:  
#&gt; Likelihood ratio = 4.2782, df = 2, p-value = 0.1178
#&gt; sample estimates:
#&gt; Log likelihood of mixed Log likelihood of error 
#&gt;               -182.0161               -184.1552 
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/anova'>anova</a></span>(<span class='no'>lag</span>, <span class='no'>lm.mod</span>)</div><div class='output co'>#&gt;        Model df    AIC  logLik Test L.Ratio   p-value
#&gt; lag        1  5 376.34 -183.17    1                  
#&gt; lm.mod     2  4 382.75 -187.38    2  8.4179 0.0037154</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/anova'>anova</a></span>(<span class='no'>lag</span>, <span class='no'>error</span>, <span class='no'>mixed</span>)</div><div class='output co'>#&gt;       Model df    AIC  logLik Test L.Ratio p-value
#&gt; lag       1  5 376.34 -183.17    1                
#&gt; error     2  5 378.31 -184.16    1                
#&gt; mixed     3  7 378.03 -182.02    2  4.2782 0.11776</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/AIC'>AIC</a></span>(<span class='no'>lag</span>, <span class='no'>error</span>, <span class='no'>mixed</span>)</div><div class='output co'>#&gt;       df      AIC
#&gt; lag    5 376.3366
#&gt; error  5 378.3104
#&gt; mixed  7 378.0322</div><div class='input'><span class='fu'>bptest.sarlm</span>(<span class='no'>error</span>)</div><div class='output co'>#&gt; 
#&gt; 	studentized Breusch-Pagan test
#&gt; 
#&gt; data:  
#&gt; BP = 9.3694, df = 2, p-value = 0.009235
#&gt; </div><div class='input'><span class='fu'>bptest.sarlm</span>(<span class='no'>error</span>, <span class='kw'>studentize</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; 
#&gt; 	Breusch-Pagan test
#&gt; 
#&gt; data:  
#&gt; BP = 16.285, df = 2, p-value = 0.0002908
#&gt; </div><div class='input'><span class='no'>lm.target</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/lm'>lm</a></span>(<span class='no'>error</span>$<span class='no'>tary</span> ~ <span class='no'>error</span>$<span class='no'>tarX</span> - <span class='fl'>1</span>)
<span class='kw'>if</span> (<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>lmtest</span>, <span class='kw'>quietly</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='kw'>&amp;&amp;</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>sandwich</span>, <span class='kw'>quietly</span><span class='kw'>=</span><span class='fl'>TRUE</span>)) {
  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/lmtest/topics/coeftest'>coeftest</a></span>(<span class='no'>lm.target</span>, <span class='kw'>vcov</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sandwich/topics/vcovHC'>vcovHC</a></span>(<span class='no'>lm.target</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"HC0"</span>), <span class='kw'>df</span><span class='kw'>=</span><span class='fl'>Inf</span>))
}</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘zoo’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    as.Date, as.Date.numeric</span></div><div class='output co'>#&gt; 
#&gt; z test of coefficients:
#&gt; 
#&gt;                                         Estimate Std. Error z value Pr(&gt;|z|)
#&gt; error$tarXI(x - lambda * WX)(Intercept) 61.05362    4.69780 12.9962  &lt; 2e-16
#&gt; error$tarXI(x - lambda * WX)HOVAL       -0.30798    0.16434 -1.8740  0.06093
#&gt; error$tarXI(x - lambda * WX)INC         -0.99547    0.44404 -2.2418  0.02497
#&gt;                                            
#&gt; error$tarXI(x - lambda * WX)(Intercept) ***
#&gt; error$tarXI(x - lambda * WX)HOVAL       .  
#&gt; error$tarXI(x - lambda * WX)INC         *  
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Roger Bivand <a href='mailto:Roger.Bivand@nhh.no'>Roger.Bivand@nhh.no</a>, <code>bptest</code>: Torsten Hothorn and Achim Zeileis, modified by Roger Bivand</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand, Gianfranco Piras.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

