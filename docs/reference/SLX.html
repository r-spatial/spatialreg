<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Spatial Durbin linear (SLX, spatially lagged X) model — lmSLX • spatialreg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial Durbin linear (SLX, spatially lagged X) model — lmSLX"><meta name="description" content="lmSLX fits an lm model augmented with the spatially lagged RHS variables, including the lagged intercept when the spatial weights are not row-standardised. create_WX creates spatially lagged RHS variables, and is exposed for use in model fitting functions."><meta property="og:description" content="lmSLX fits an lm model augmented with the spatially lagged RHS variables, including the lagged intercept when the spatial weights are not row-standardised. create_WX creates spatially lagged RHS variables, and is exposed for use in model fitting functions."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spatialreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a></li>
    <li><a class="dropdown-item" href="../articles/sids_models.html">North Carolina SIDS data set (models)</a></li>
    <li><a class="dropdown-item" href="../articles/SpatialFiltering.html">Moran Eigenvectors</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-spatial/spatialreg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Spatial Durbin linear (SLX, spatially lagged X) model</h1>

      <div class="d-none name"><code>SLX.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>lmSLX</code> fits an <code>lm</code> model augmented with the spatially lagged RHS variables, including the lagged intercept when the spatial weights are not row-standardised. <code>create_WX</code> creates spatially lagged RHS variables, and is exposed for use in model fitting functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lmSLX</span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">listw</span>, <span class="va">na.action</span>, weights<span class="op">=</span><span class="cn">NULL</span>, Durbin<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span> zero.policy<span class="op">=</span><span class="cn">NULL</span>, return_impacts<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'SlX'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3L</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'SlX'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, correlation <span class="op">=</span> <span class="cn">FALSE</span>, symbolic.cor <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'summary.SlX'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3L</span><span class="op">)</span>,</span>
<span> symbolic.cor <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">symbolic.cor</span>, signif.stars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"show.signif.stars"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'SlX'</span></span>
<span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'WXimpact'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'WXimpact'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, adjust_k<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">object</span>, <span class="st">"type"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"SDEM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'SlX'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">listw</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">create_WX</span><span class="op">(</span><span class="va">x</span>, <span class="va">listw</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span>, prefix<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a symbolic description of the model to be fit. The details
of model specification are given for <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code></p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment which the function
is called.</p></dd>

  <dt id="arg-listw">listw<a class="anchor" aria-label="anchor" href="#arg-listw"></a></dt>
<dd><p>a <code>listw</code> object created for example by <code>nb2listw</code></p></dd>

  <dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>a function (default <code>options("na.action")</code>), can also be <code>na.omit</code> or <code>na.exclude</code> with consequences for residuals and fitted values - in these cases the spatial weights list will be subsetted to remove NAs in the data. It may be necessary to set zero.policy to TRUE because this subsetting may create no-neighbour observations. Note that only weights lists created without using the glist argument to <code>nb2listw</code> may be subsetted.</p></dd>

  <dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>an optional vector of weights to be used in the fitting process. Non-NULL weights can be used to indicate that different observations have different variances (with the values in weights being inversely proportional to the variances); or equivalently, when the elements of weights are positive integers w_i, that each response y_i is the mean of w_i unit-weight observations (including the case that there are w_i observations equal to y_i and the data have been summarized) - <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code></p></dd>

  <dt id="arg-durbin">Durbin<a class="anchor" aria-label="anchor" href="#arg-durbin"></a></dt>
<dd><p>default TRUE for <code>lmSLX</code> (Durbin model including WX); if TRUE, full spatial Durbin model; if a formula object, the subset of explanatory variables to lag. From version 1.3-7, the presence of factors (categorical variables) in the Durbin term will give a warning, as it is as yet unknown how spatial lags of categorical variables should be interpreted.</p></dd>

  <dt id="arg-zero-policy">zero.policy<a class="anchor" aria-label="anchor" href="#arg-zero-policy"></a></dt>
<dd><p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without neighbours, if FALSE assign NA</p></dd>

  <dt id="arg-return-impacts">return_impacts<a class="anchor" aria-label="anchor" href="#arg-return-impacts"></a></dt>
<dd><p>default TRUE; may be set FALSE to avoid problems calculating impacts with aliased variables</p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>the number of significant digits to use when printing</p></dd>

  <dt id="arg-correlation">correlation<a class="anchor" aria-label="anchor" href="#arg-correlation"></a></dt>
<dd><p>logical; if <code>TRUE</code>, the correlation matrix of the estimated parameters is returned and printed</p></dd>

  <dt id="arg-symbolic-cor">symbolic.cor<a class="anchor" aria-label="anchor" href="#arg-symbolic-cor"></a></dt>
<dd><p>logical. If <code>TRUE</code>, print the correlations in a symbolic form (see 'symnum') rather than as numbers</p></dd>

  <dt id="arg-signif-stars">signif.stars<a class="anchor" aria-label="anchor" href="#arg-signif-stars"></a></dt>
<dd><p>logical. If <code>TRUE</code>, 'significance stars' are printed for each coefficient</p></dd>

  <dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>A spatial regression object created by <code>lmSLX</code></p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed through</p></dd>

  <dt id="arg-prefix">prefix<a class="anchor" aria-label="anchor" href="#arg-prefix"></a></dt>
<dd><p>default empty string, may be “lag” in some cases</p></dd>

  <dt id="arg-x-object">x, object<a class="anchor" aria-label="anchor" href="#arg-x-object"></a></dt>
<dd><p>model matrix to be lagged; lagImpact objects created by <code>impacts</code> methods</p></dd>

  <dt id="arg-adjust-k">adjust_k<a class="anchor" aria-label="anchor" href="#arg-adjust-k"></a></dt>
<dd><p>default TRUE if SDEM else FALSE, adjust internal OLS SDEM standard errors by dividing by n rather than (n-k) (default changed and bug fixed after 0.7-8; standard errors now ML in SDEM summary and impacts summary and identical - for SLX use FALSE)</p></dd>

  <dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>data frame in which to predict — if NULL, predictions are
for the data on which the model was fitted. Should have row names corresponding to region.id. If row names are exactly the same than the ones used for training, it uses in-sample predictors for forecast.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The <code>lmSLX</code> function returns an “lm” object with a “mixedImps” list of three impact matrixes (impacts and standard errors) for direct, indirect and total impacts; total impacts and their standard errors calculated using <code><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">multcomp::glht</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>From version 1.4.1, functions for models including spatially lagged independent variables warn on fitting if any of the right-hand side variables are factors. This is because the interpretation of coefficients that are not slopes is unclear when the variable is not interpretable on an unbounded line, such as factors. Factor variable names are shown with the suffix “(F)”, others “dy/dx” in output from impact methods. A discussion can be found at <a href="https://github.com/rsbivand/eqc25_talk" class="external-link">https://github.com/rsbivand/eqc25_talk</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">oldcol</span>, package<span class="op">=</span><span class="st">"spdep"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span>, style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.SLX</span> <span class="op">&lt;-</span> <span class="fu">lmSLX</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1], collapse = "+"))), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = as.data.frame(x), weights = weights)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate    Std. Error  t value     Pr(&gt;|t|)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   7.503e+01   6.626e+00   1.132e+01   1.261e-14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC          -1.109e+00   3.738e-01  -2.967e+00   4.854e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL        -2.897e-01   1.014e-01  -2.858e+00   6.486e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.INC      -1.371e+00   5.613e-01  -2.443e+00   1.867e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.HOVAL     1.918e-01   2.003e-01   9.572e-01   3.437e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Impact measures (SlX, glht, n-k):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Direct   Indirect       Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx   -1.1089293 -1.3709725 -2.47990173</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx -0.2897283  0.1917608 -0.09796753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard errors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Direct  Indirect     Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx   0.3738129 0.5612771 0.4965456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx 0.1013673 0.2003335 0.2028016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Direct   Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx   -2.966535 -2.4425945 -4.9943086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx -2.858202  0.9572079 -0.4830709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Direct    Indirect Total     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx   0.0030118 0.014582 5.9047e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx 0.0042605 0.338462 0.62905   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">COL.SLX</span> <span class="op">&lt;-</span> <span class="fu">lmSLX</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">HOVAL</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span>, Durbin<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Impact measures (SlX, glht, n-k):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        Direct     Indirect       Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx        -0.947594274 -1.275338647 -2.22293292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx      -0.777427839 -0.355048446 -1.13247628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2) dy/dx  0.004639919  0.005608104  0.01024802</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard errors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       Direct   Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx        0.398832844 0.59687399 0.56325440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx      0.464456540 0.98213200 1.07348981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2) dy/dx 0.004226259 0.00908385 0.01025212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Direct   Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx        -2.375918 -2.1366966 -3.9465877</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx      -1.673844 -0.3615079 -1.0549483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2) dy/dx  1.097879  0.6173709  0.9996008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Direct   Indirect Total     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx        0.017505 0.032623 7.9273e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx      0.094161 0.717720 0.29145   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2) dy/dx 0.272258 0.536990 0.31750   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1], collapse = "+"))), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = as.data.frame(x), weights = weights)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Estimate    Std. Error  t value     Pr(&gt;|t|)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)      9.246e+01   1.928e+01   4.796e+00   2.058e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC             -9.476e-01   3.988e-01  -2.376e+00   2.214e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL           -7.774e-01   4.645e-01  -1.674e+00   1.016e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I.HOVAL.2.       4.640e-03   4.226e-03   1.098e+00   2.785e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.INC         -1.275e+00   5.969e-01  -2.137e+00   3.849e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.HOVAL       -3.550e-01   9.821e-01  -3.615e-01   7.195e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.I.HOVAL.2.   5.608e-03   9.084e-03   6.174e-01   5.403e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">COL.SLX</span> <span class="op">&lt;-</span> <span class="fu">lmSLX</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">HOVAL</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span>, Durbin<span class="op">=</span><span class="op">~</span><span class="va">INC</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Impact measures (SlX, glht, n-k):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        Direct  Indirect        Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx        -1.079064628 -1.010896 -2.089960575</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx      -0.634518755        NA -0.634518755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2) dy/dx  0.003455273        NA  0.003455273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard errors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Direct  Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx        0.38471071 0.4552667 0.44650193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx      0.44760078        NA 0.44760078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2) dy/dx 0.00411036        NA 0.00411036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Direct  Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx        -2.8048728 -2.220448 -4.6807425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx      -1.4175997        NA -1.4175997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2) dy/dx  0.8406254        NA  0.8406254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Direct    Indirect Total     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx        0.0050336 0.026388 2.8584e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx      0.1563077 NA       0.15631   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2) dy/dx 0.4005579 NA       0.40056   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1], collapse = "+"))), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = as.data.frame(x), weights = weights)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate    Std. Error  t value     Pr(&gt;|t|)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   8.368e+01   9.265e+00   9.032e+00   1.401e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC          -1.079e+00   3.847e-01  -2.805e+00   7.466e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL        -6.345e-01   4.476e-01  -1.418e+00   1.634e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I.HOVAL.2.    3.455e-03   4.110e-03   8.406e-01   4.051e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.INC      -1.011e+00   4.553e-01  -2.220e+00   3.159e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">COL.SLX</span> <span class="op">&lt;-</span> <span class="fu">lmSLX</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1], collapse = "+"))), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = as.data.frame(x), weights = weights)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate    Std. Error  t value     Pr(&gt;|t|)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   7.398e+01   6.208e+00   1.192e+01   1.155e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC          -1.589e+00   3.564e-01  -4.458e+00   5.276e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.INC      -1.086e+00   4.812e-01  -2.257e+00   2.882e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Impact measures (SlX, glht, n-k):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Direct  Indirect     Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx -1.588901 -1.085867 -2.674768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard errors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Direct  Indirect    Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx 0.3564039 0.4811809 0.407313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Direct  Indirect     Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx -4.458147 -2.256671 -6.566861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Direct     Indirect Total     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx 8.2671e-06 0.024029 5.1387e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">crds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">X</span>, <span class="va">COL.OLD</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">crds</span>, <span class="fl">2</span>, <span class="va">range</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dnb</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/dnearneigh.html" class="external-link">dnearneigh</a></span><span class="op">(</span><span class="va">crds</span>, <span class="fl">0</span>, <span class="va">mdist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dists</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nbdists.html" class="external-link">nbdists</a></span><span class="op">(</span><span class="va">dnb</span>, <span class="va">crds</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">form</span>, <span class="va">data</span>, <span class="va">dnb</span>, <span class="va">dists</span>, <span class="va">verbose</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">glst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">dists</span>, <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">d</span><span class="op">^</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">dnb</span>, glist<span class="op">=</span><span class="va">glst</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="fu">lmSLX</span><span class="op">(</span>form<span class="op">=</span><span class="va">form</span>, data<span class="op">=</span><span class="va">data</span>, listw<span class="op">=</span><span class="va">lw</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="va">verbose</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"power:"</span>, <span class="va">x</span>, <span class="st">"logLik:"</span>, <span class="va">res</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">res</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">optimize</a></span><span class="op">(</span><span class="va">f</span>, interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">4</span><span class="op">)</span>, form<span class="op">=</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>,</span></span>
<span class="r-in"><span> data<span class="op">=</span><span class="va">COL.OLD</span>, dnb<span class="op">=</span><span class="va">dnb</span>, dists<span class="op">=</span><span class="va">dists</span>, verbose<span class="op">=</span><span class="cn">TRUE</span>, maximum<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.589667 logLik: -172.6864 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 2.510333 logLik: -177.741 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.020665 logLik: -171.5379 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 0.8721475 logLik: -171.7979 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.11302 logLik: -171.4973 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.107329 logLik: -171.497 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.105705 logLik: -171.497 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.105746 logLik: -171.497 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.105664 logLik: -171.497 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.105705 logLik: -171.497 </span>
<span class="r-in"><span><span class="va">glst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">dists</span>, <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">d</span><span class="op">^</span><span class="va">opt</span><span class="op">$</span><span class="va">maximum</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">dnb</span>, glist<span class="op">=</span><span class="va">glst</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">SLX</span> <span class="op">&lt;-</span> <span class="fu">lmSLX</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SLX</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1], collapse = "+"))), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = as.data.frame(x), weights = weights)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Estimate  Std. Error  t value   Pr(&gt;|t|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)      18.78498  11.23795     1.67157   0.10187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC              -0.65428   0.29463    -2.22064   0.03169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL            -0.18244   0.08138    -2.24174   0.03019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag..Intercept.   6.27790   4.44284     1.41304   0.16484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.INC          -0.12958   0.28794    -0.45002   0.65496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.HOVAL         0.02668   0.11273     0.23664   0.81406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">SLX</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Impact measures (SlX, glht, n-k):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Direct    Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx   -0.6542760 -0.12957739 -0.7838534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx -0.1824383  0.02667561 -0.1557627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard errors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Direct  Indirect     Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx   0.29463342 0.2879383 0.3742251</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx 0.08138257 0.1127279 0.1404591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Direct   Indirect     Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx   -2.220644 -0.4500179 -2.094604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx -2.241736  0.2366371 -1.108954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Direct   Indirect Total   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC dy/dx   0.026375 0.65270  0.036206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL dy/dx 0.024978 0.81294  0.267450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="va">COL.SLX</span> <span class="op">&lt;-</span> <span class="fu">lmSLX</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pslx0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pslx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.SLX</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in predict.SlX(COL.SLX, newdata = COL.OLD, listw = lw):</span> mismatch between newdata and spatial weights. newdata should have region.id as row.names</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">pslx0</span>, <span class="va">pslx1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'current' in selecting a method for function 'all.equal': object 'pslx1' not found</span>
<span class="r-in"><span><span class="va">COL.OLD1</span> <span class="op">&lt;-</span> <span class="va">COL.OLD</span></span></span>
<span class="r-in"><span><span class="va">COL.OLD1</span><span class="op">$</span><span class="va">INC</span> <span class="op">&lt;-</span> <span class="va">COL.OLD1</span><span class="op">$</span><span class="va">INC</span> <span class="op">+</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">pslx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.SLX</span>, newdata<span class="op">=</span><span class="va">COL.OLD1</span>, listw<span class="op">=</span><span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in predict.SlX(COL.SLX, newdata = COL.OLD1, listw = lw):</span> mismatch between newdata and spatial weights. newdata should have region.id as row.names</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.623621</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pslx2</span><span class="op">-</span><span class="va">pslx1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'mean': object 'pslx2' not found</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Roger Bivand, Gianfranco Piras.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

