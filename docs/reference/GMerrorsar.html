<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Spatial simultaneous autoregressive error model estimation by GMM — GMerrorsar • spatialreg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial simultaneous autoregressive error model estimation by GMM — GMerrorsar"><meta name="description" content="An implementation of Kelejian and Prucha's generalised moments estimator for the autoregressive parameter in a spatial model."><meta property="og:description" content="An implementation of Kelejian and Prucha's generalised moments estimator for the autoregressive parameter in a spatial model."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spatialreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a></li>
    <li><a class="dropdown-item" href="../articles/sids_models.html">North Carolina SIDS data set (models)</a></li>
    <li><a class="dropdown-item" href="../articles/SpatialFiltering.html">Moran Eigenvectors</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-spatial/spatialreg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Spatial simultaneous autoregressive error model estimation by GMM</h1>

      <div class="d-none name"><code>GMerrorsar.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>An implementation of Kelejian and Prucha's generalised moments estimator for the autoregressive parameter in a spatial model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">GMerrorsar</span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">listw</span>, na.action <span class="op">=</span> <span class="va">na.fail</span>,</span>
<span> zero.policy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">listw</span>, <span class="st">"zero.policy"</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"nlminb"</span>, arnoldWied<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span> control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">pars</span>, scaleU<span class="op">=</span><span class="cn">FALSE</span>, verbose<span class="op">=</span><span class="cn">NULL</span>, legacy<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span> se.lambda<span class="op">=</span><span class="cn">TRUE</span>, returnHcov<span class="op">=</span><span class="cn">FALSE</span>, pWOrder<span class="op">=</span><span class="fl">250</span>, tol.Hcov<span class="op">=</span><span class="fl">1.0e-10</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'Gmsar'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, correlation <span class="op">=</span> <span class="cn">FALSE</span>, Hausman<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">GMargminImage</span><span class="op">(</span><span class="va">obj</span>, <span class="va">lambdaseq</span>, <span class="va">s2seq</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a symbolic description of the model to be fit. The details
of model specification are given for <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code></p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment which the function
is called.</p></dd>

  <dt id="arg-listw">listw<a class="anchor" aria-label="anchor" href="#arg-listw"></a></dt>
<dd><p>a <code>listw</code> object created for example by <code>nb2listw</code></p></dd>

  <dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>a function (default <code>na.fail</code>), can also be <code>na.omit</code> or <code>na.exclude</code> with consequences for residuals and fitted values - in these cases the weights list will be subsetted to remove NAs in the data. It may be necessary to set zero.policy to TRUE because this subsetting may create no-neighbour observations. Note that only weights lists created without using the glist argument to <code>nb2listw</code> may be subsetted.</p></dd>

  <dt id="arg-zero-policy">zero.policy<a class="anchor" aria-label="anchor" href="#arg-zero-policy"></a></dt>
<dd><p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without
neighbours, if FALSE (default) assign NA - causing <code>GMerrorsar()</code> to terminate with an error</p></dd>

  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>default <code>"nlminb"</code>, or optionally a method passed to <code>optim</code> to use an alternative optimizer</p></dd>

  <dt id="arg-arnoldwied">arnoldWied<a class="anchor" aria-label="anchor" href="#arg-arnoldwied"></a></dt>
<dd><p>default FALSE</p></dd>

  <dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A list of control parameters. See details in <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> or <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></code>.</p></dd>

  <dt id="arg-pars">pars<a class="anchor" aria-label="anchor" href="#arg-pars"></a></dt>
<dd><p>starting values for \(\lambda\) and \(\sigma^2\) for GMM optimisation, if missing (default), approximated from initial OLS model as the autocorrelation coefficient corrected for weights style and model sigma squared</p></dd>

  <dt id="arg-scaleu">scaleU<a class="anchor" aria-label="anchor" href="#arg-scaleu"></a></dt>
<dd><p>Default FALSE: scale the OLS residuals before computing the moment matrices; only used if the <code>pars</code> argument is missing</p></dd>

  <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>default NULL, use global option value; if TRUE, reports function values during optimization.</p></dd>

  <dt id="arg-legacy">legacy<a class="anchor" aria-label="anchor" href="#arg-legacy"></a></dt>
<dd><p>default FALSE - compute using the unfiltered values of the response and right hand side variables; if TRUE - compute the fitted value and residuals from the spatially filtered model using the spatial error parameter</p></dd>

  <dt id="arg-se-lambda">se.lambda<a class="anchor" aria-label="anchor" href="#arg-se-lambda"></a></dt>
<dd><p>default TRUE, use the analytical method described in <a href="http://econweb.umd.edu/~prucha/STATPROG/OLS/desols.pdf" class="external-link">http://econweb.umd.edu/~prucha/STATPROG/OLS/desols.pdf</a></p></dd>

  <dt id="arg-returnhcov">returnHcov<a class="anchor" aria-label="anchor" href="#arg-returnhcov"></a></dt>
<dd><p>default FALSE, return the Vo matrix for a spatial Hausman test</p></dd>

  <dt id="arg-tol-hcov">tol.Hcov<a class="anchor" aria-label="anchor" href="#arg-tol-hcov"></a></dt>
<dd><p>the tolerance for computing the Vo matrix (default=1.0e-10)</p></dd>

  <dt id="arg-pworder">pWOrder<a class="anchor" aria-label="anchor" href="#arg-pworder"></a></dt>
<dd><p>default 250, if returnHcov=TRUE, pass this order to <code>powerWeights</code> as the power series maximum limit</p></dd>

  <dt id="arg-object-obj">object, obj<a class="anchor" aria-label="anchor" href="#arg-object-obj"></a></dt>
<dd><p><code>Gmsar</code> object from <code>GMerrorsar</code></p></dd>

  <dt id="arg-correlation">correlation<a class="anchor" aria-label="anchor" href="#arg-correlation"></a></dt>
<dd><p>logical; (default=FALSE), TRUE not available</p></dd>

  <dt id="arg-hausman">Hausman<a class="anchor" aria-label="anchor" href="#arg-hausman"></a></dt>
<dd><p>if TRUE, the results of the Hausman test for error models are reported</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p><code>summary</code> arguments passed through</p></dd>

  <dt id="arg-lambdaseq">lambdaseq<a class="anchor" aria-label="anchor" href="#arg-lambdaseq"></a></dt>
<dd><p>if given, an increasing sequence of lambda values for gridding</p></dd>

  <dt id="arg-s-seq">s2seq<a class="anchor" aria-label="anchor" href="#arg-s-seq"></a></dt>
<dd><p>if given, an increasing sequence of sigma squared values for gridding</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When the control list is set with care, the function will converge to values close to the ML estimator without requiring computation of the Jacobian, the most resource-intensive part of ML estimation.</p>
<p>Note that the fitted() function for the output object assumes that the response
variable may be reconstructed as the sum of the trend, the signal, and the
noise (residuals). Since the values of the response variable are known,
their spatial lags are used to calculate signal components (Cressie 1993, p. 564). This differs from other software, including GeoDa, which does not use knowledge of the response
variable in making predictions for the fitting data.</p>
<p>The <code>GMargminImage</code> may be used to visualize the shape of the surface of the argmin function used to find lambda.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list object of class <code>Gmsar</code></p>
<dl><dt>type</dt>
<dd><p>"ERROR"</p></dd>

  <dt>lambda</dt>
<dd><p>simultaneous autoregressive error coefficient</p></dd>

  <dt>coefficients</dt>
<dd><p>GMM coefficient estimates</p></dd>

  <dt>rest.se</dt>
<dd><p>GMM coefficient standard errors</p></dd>

  <dt>s2</dt>
<dd><p>GMM residual variance</p></dd>

  <dt>SSE</dt>
<dd><p>sum of squared GMM errors</p></dd>

  <dt>parameters</dt>
<dd><p>number of parameters estimated</p></dd>

  <dt>lm.model</dt>
<dd><p>the <code>lm</code> object returned when estimating for \(\lambda=0\)</p></dd>

  <dt>call</dt>
<dd><p>the call used to create this object</p></dd>

  <dt>residuals</dt>
<dd><p>GMM residuals</p></dd>

  <dt>lm.target</dt>
<dd><p>the <code>lm</code> object returned for the GMM fit</p></dd>

  <dt>fitted.values</dt>
<dd><p>Difference between residuals and response variable</p></dd>

  <dt>formula</dt>
<dd><p>model formula</p></dd>

  <dt>aliased</dt>
<dd><p>if not NULL, details of aliased variables</p></dd>

  <dt>zero.policy</dt>
<dd><p>zero.policy for this model</p></dd>

  <dt>vv</dt>
<dd><p>list of internal bigG and litg components for testing optimisation surface</p></dd>

  <dt>optres</dt>
<dd><p>object returned by optimizer</p></dd>

  <dt>pars</dt>
<dd><p>start parameter values for optimisation</p></dd>

  <dt>Hcov</dt>
<dd><p>Spatial DGP covariance matrix for Hausman test if available</p></dd>

  <dt>legacy</dt>
<dd><p>input choice of unfiltered or filtered values</p></dd>

  <dt>lambda.se</dt>
<dd><p>value computed if input argument TRUE</p></dd>

  <dt>arnoldWied</dt>
<dd><p>were Arnold-Wied moments used</p></dd>

  <dt>GMs2</dt>
<dd><p>GM argmin sigma squared</p></dd>

  <dt>scaleU</dt>
<dd><p>input choice of scaled OLS residuals</p></dd>

  <dt>vcov</dt>
<dd><p>variance-covariance matrix of regression coefficients</p></dd>

  <dt>na.action</dt>
<dd><p>(possibly) named vector of excluded or omitted observations if non-default na.action argument used</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kelejian, H. H., and Prucha, I. R., 1999. A Generalized Moments Estimator for the Autoregressive Parameter in a Spatial Model. International Economic Review, 40, pp. 509–533; Cressie, N. A. C. 1993 <em>Statistics for spatial data</em>, Wiley, New York.</p>
<p>Roger Bivand, Gianfranco Piras (2015). Comparing Implementations of Estimation Methods for Spatial Econometrics. <em>Journal of Statistical Software</em>, 63(18), 1-36. <a href="https://doi.org/10.18637/jss.v063.i18" class="external-link">doi:10.18637/jss.v063.i18</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Luc Anselin and Roger Bivand</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>, <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></code>, <code><a href="ML_models.html">errorsarlm</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#require("spdep", quietly=TRUE)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">oldcol</span>, package<span class="op">=</span><span class="st">"spdep"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.errW.eig</span> <span class="op">&lt;-</span> <span class="fu"><a href="ML_models.html">errorsarlm</a></span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span>, style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"eigen"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.errW.eig</span>, Hausman<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> errorsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = spdep::nb2listw(COL.nb, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     style = "W"), method = "eigen")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -34.81174  -6.44031  -0.72142   7.61476  23.33626 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: error </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (asymptotic standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 59.893219   5.366163 11.1613 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -0.941312   0.330569 -2.8476 0.0044057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.302250   0.090476 -3.3407 0.0008358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.56179, LR test value: 7.9935, p-value: 0.0046945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymptotic standard error: 0.13387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z-value: 4.1966, p-value: 2.7098e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald statistic: 17.611, p-value: 2.7098e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -183.3805 for error model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 95.575, (sigma: 9.7762)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 376.76, (AIC for lm: 382.75)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hausman test: 4.902, df: 3, p-value: 0.17911</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Std. Error   z value     Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 59.8932192 5.36616252 11.161276 0.0000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -0.9413120 0.33056857 -2.847554 0.0044056569</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.3022502 0.09047605 -3.340665 0.0008357788</span>
<span class="r-in"><span><span class="va">COL.errW.GM</span> <span class="op">&lt;-</span> <span class="fu">GMerrorsar</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span>, style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span>, returnHcov<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.errW.GM</span>, Hausman<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GMerrorsar(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = spdep::nb2listw(COL.nb, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     style = "W"), returnHcov = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -30.5432  -6.5553  -2.1921  10.0553  28.7497 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: GM SAR estimator</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (GM standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 62.513752   5.121339  12.207 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -1.128283   0.339745  -3.321  0.000897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.296957   0.095699  -3.103  0.001915</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.40196 (standard error): 0.42334 (z-value): 0.94948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual variance (sigma squared): 106.64, (sigma: 10.327)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GM argmin sigma squared: 106.36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hausman test: 6.6406, df: 3, p-value: 0.08428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Std. Error   z value     Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 62.5137525 5.12133863 12.206526 0.0000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -1.1282834 0.33974492 -3.320972 0.0008970455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.2969573 0.09569889 -3.103038 0.0019154486</span>
<span class="r-in"><span><span class="va">aa</span> <span class="op">&lt;-</span> <span class="fu">GMargminImage</span><span class="op">(</span><span class="va">COL.errW.GM</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">levs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">aa</span><span class="op">$</span><span class="va">z</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">aa</span>, breaks<span class="op">=</span><span class="va">levs</span>, xlab<span class="op">=</span><span class="st">"lambda"</span>, ylab<span class="op">=</span><span class="st">"s2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">COL.errW.GM</span><span class="op">$</span><span class="va">lambda</span>, <span class="va">COL.errW.GM</span><span class="op">$</span><span class="va">s2</span>, pch<span class="op">=</span><span class="fl">3</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">aa</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="va">levs</span>, <span class="fl">4</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="GMerrorsar-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">COL.errW.GM1</span> <span class="op">&lt;-</span> <span class="fu">GMerrorsar</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span>, style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.errW.GM1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GMerrorsar(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = spdep::nb2listw(COL.nb, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     style = "W"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -30.5432  -6.5553  -2.1921  10.0553  28.7497 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: GM SAR estimator</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (GM standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 62.513752   5.121339  12.207 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -1.128283   0.339745  -3.321  0.000897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.296957   0.095699  -3.103  0.001915</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.40196 (standard error): 0.42334 (z-value): 0.94948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual variance (sigma squared): 106.64, (sigma: 10.327)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GM argmin sigma squared: 106.36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://r-spatial.github.io/sf/" class="external-link">"sf"</a></span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"shapes/NY8_bna_utm18.gpkg"</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="va">nyadjmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">foreign</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.dbf.html" class="external-link">read.dbf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="st">"misc/nyadjwts.dbf"</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu">foreign</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.dbf.html" class="external-link">read.dbf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="st">"misc/nyadjwts.dbf"</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">ID</span>, <span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">nydata</span><span class="op">$</span><span class="va">AREAKEY</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="va">listw_NY</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/mat2listw.html" class="external-link">mat2listw</a></span><span class="op">(</span><span class="va">nyadjmat</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">nydata</span><span class="op">$</span><span class="va">AREAKEY</span><span class="op">)</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">esar1f</span> <span class="op">&lt;-</span> <span class="fu"><a href="spautolm.html">spautolm</a></span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>, data<span class="op">=</span><span class="va">nydata</span>,</span></span>
<span class="r-in"><span> listw<span class="op">=</span><span class="va">listw_NY</span>, family<span class="op">=</span><span class="st">"SAR"</span>, method<span class="op">=</span><span class="st">"eigen"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esar1f</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spautolm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = nydata, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     listw = listw_NY, family = "SAR", method = "eigen")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.56754 -0.38239 -0.02643  0.33109  4.01219 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.618193   0.176784 -3.4969 0.0004707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.071014   0.042051  1.6888 0.0912635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    3.754200   0.624722  6.0094 1.862e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.419890   0.191329 -2.1946 0.0281930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.040487 LR test value: 5.2438 p-value: 0.022026 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Numerical Hessian standard error of lambda: 0.017197 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log likelihood: -276.1069 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ML residual variance (sigma squared): 0.41388, (sigma: 0.64333)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 564.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">esar1gm</span> <span class="op">&lt;-</span> <span class="fu">GMerrorsar</span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>,</span></span>
<span class="r-in"><span> data<span class="op">=</span><span class="va">nydata</span>, listw<span class="op">=</span><span class="va">listw_NY</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esar1gm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:GMerrorsar(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = nydata, listw = listw_NY)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.641411 -0.396370 -0.026618  0.341740  4.204264 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: GM SAR estimator</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (GM standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.604364   0.174576 -3.4619 0.0005364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.067902   0.041164  1.6496 0.0990337</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    3.775308   0.622965  6.0602 1.359e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.437545   0.188906 -2.3162 0.0205468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.03605 (standard error): 0.2022 (z-value): 0.17829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual variance (sigma squared): 0.41585, (sigma: 0.64487)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GM argmin sigma squared: 0.45141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">esar1gm1</span> <span class="op">&lt;-</span> <span class="fu">GMerrorsar</span><span class="op">(</span><span class="va">Z</span> <span class="op">~</span> <span class="va">PEXPOSURE</span> <span class="op">+</span> <span class="va">PCTAGE65P</span> <span class="op">+</span> <span class="va">PCTOWNHOME</span>,</span></span>
<span class="r-in"><span> data<span class="op">=</span><span class="va">nydata</span>, listw<span class="op">=</span><span class="va">listw_NY</span>, method<span class="op">=</span><span class="st">"Nelder-Mead"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esar1gm1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:GMerrorsar(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = nydata, listw = listw_NY, method = "Nelder-Mead")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.641390 -0.396374 -0.026616  0.341745  4.204277 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type: GM SAR estimator</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (GM standard errors) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.604384   0.174580 -3.4619 0.0005363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PEXPOSURE    0.067907   0.041165  1.6496 0.0990225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTAGE65P    3.775275   0.622969  6.0601  1.36e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCTOWNHOME  -0.437518   0.188910 -2.3160 0.0205572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda: 0.036057 (standard error): 0.20221 (z-value): 0.17832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual variance (sigma squared): 0.41585, (sigma: 0.64487)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GM argmin sigma squared: 0.45139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters estimated: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Roger Bivand, Gianfranco Piras.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

