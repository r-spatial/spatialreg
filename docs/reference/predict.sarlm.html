<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Prediction for spatial simultaneous autoregressive linear model objects — predict.Sarlm • spatialreg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prediction for spatial simultaneous autoregressive linear model objects — predict.Sarlm"><meta name="description" content="predict.Sarlm() calculates predictions as far as is at present possible for for spatial simultaneous autoregressive linear
model objects, using Haining's terminology for decomposition into
trend, signal, and noise, or other types of predictors — see references."><meta property="og:description" content="predict.Sarlm() calculates predictions as far as is at present possible for for spatial simultaneous autoregressive linear
model objects, using Haining's terminology for decomposition into
trend, signal, and noise, or other types of predictors — see references."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spatialreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a></li>
    <li><a class="dropdown-item" href="../articles/sids_models.html">North Carolina SIDS data set (models)</a></li>
    <li><a class="dropdown-item" href="../articles/SpatialFiltering.html">Moran Eigenvectors</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-spatial/spatialreg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Prediction for spatial simultaneous autoregressive linear model objects</h1>

      <div class="d-none name"><code>predict.sarlm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>predict.Sarlm()</code> calculates predictions as far as is at present possible for for spatial simultaneous autoregressive linear
model objects, using Haining's terminology for decomposition into
trend, signal, and noise, or other types of predictors — see references.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'Sarlm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, newdata <span class="op">=</span> <span class="cn">NULL</span>, listw <span class="op">=</span> <span class="cn">NULL</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span>, all.data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span> zero.policy <span class="op">=</span> <span class="cn">NULL</span>, legacy <span class="op">=</span> <span class="cn">TRUE</span>, legacy.mixed <span class="op">=</span> <span class="cn">FALSE</span>, power <span class="op">=</span> <span class="cn">NULL</span>, order <span class="op">=</span> <span class="fl">250</span>,</span>
<span> tol <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="op">(</span><span class="fl">3</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span>, spChk <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co">#\method{predict}{SLX}(object, newdata, listw, zero.policy=NULL, ...)</span></span>
<span><span class="co"># S3 method for class 'Sarlm.pred'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'Sarlm.pred'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p><code>Sarlm</code> object returned by <code>lagsarlm</code>,
<code>errorsarlm</code> or <code>sacsarlm</code>, the method for SLX objects takes the output of <code>lmSLX</code></p></dd>

  <dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>data frame in which to predict — if NULL, predictions are
for the data on which the model was fitted. Should have row names corresponding to region.id. If row names are exactly the same than the ones used for training, it uses in-sample predictors for forecast.  See ‘Details’</p></dd>

  <dt id="arg-listw">listw<a class="anchor" aria-label="anchor" href="#arg-listw"></a></dt>
<dd><p>a <code>listw</code> object created for example by <code>nb2listw</code>. In the out-of-sample prediction case (ie. if newdata is not NULL), if <code>legacy.mixed=FALSE</code> or if <code>pred.type!="TS"</code>, it should include both in-sample and out-of-sample spatial units. In this case, if regions of the listw are not in the correct order, they are reordered.  See ‘Details’</p></dd>

  <dt id="arg-pred-type">pred.type<a class="anchor" aria-label="anchor" href="#arg-pred-type"></a></dt>
<dd><p>predictor type — default “TS”, use decomposition into
trend, signal, and noise ; other types available depending on <code>newdata</code>. If <code>newdata=NULL</code> (in-sample prediction), “TS”, “trend”, “TC” and “BP” are available. If <code>newdata</code> is not NULL and its row names are the same than the <code>data</code> used to fit the model (forecast case), “TS”, “trend” and “TC” are available. In other cases (out-of-sample prediction), “TS”, “trend”, “KP1”, “KP2”, “KP3”, “KP4”, “KP5”, “TC”, “BP”, “BPW”, “BPN”, “TS1”, “TC1”, “BP1”, “BPW1” and “BPN1” are available.  See ‘Details’ and references</p></dd>

  <dt id="arg-all-data">all.data<a class="anchor" aria-label="anchor" href="#arg-all-data"></a></dt>
<dd><p>(only applies to <code>pred.type="TC"</code> and newdata is not NULL) default FALSE: return predictions only for newdata units, if TRUE return predictions for all data units.  See ‘Details’</p></dd>

  <dt id="arg-zero-policy">zero.policy<a class="anchor" aria-label="anchor" href="#arg-zero-policy"></a></dt>
<dd><p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without
neighbours, if FALSE (default) assign NA - causing the function to
terminate with an error</p></dd>

  <dt id="arg-legacy">legacy<a class="anchor" aria-label="anchor" href="#arg-legacy"></a></dt>
<dd><p>(only applies to lag and Durbin (mixed) models for <code>pred.type="TS"</code>) default TRUE: use ad-hoc predictor, if FALSE use DGP-based predictor</p></dd>

  <dt id="arg-legacy-mixed">legacy.mixed<a class="anchor" aria-label="anchor" href="#arg-legacy-mixed"></a></dt>
<dd><p>(only applies to mixed models if newdata is not NULL) default FALSE: compute lagged variables from both in-sample and out-of-sample units with \([W X]_O\) and \([W X]_S\) where <code>X=cbind(Xs, Xo)</code>, if TRUE compute lagged variables independantly between in-sample and out-of-sample units with \(W_{OO} X_O\) and \(W_{SS} X_S\)</p></dd>

  <dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>(only applies to lag and Durbin (mixed) models for “TS”, “KP1”, “KP2”, “KP3”, “TC”, “TC1”, “BP”, “BP1”, “BPN”, “BPN1”, “BPW” and “BPW1” types) use <code>powerWeights</code>, if default NULL, set FALSE if <code>object$method</code> is “eigen”, otherwise TRUE</p></dd>

  <dt id="arg-order">order<a class="anchor" aria-label="anchor" href="#arg-order"></a></dt>
<dd><p>power series maximum limit if <code>power</code> is TRUE</p></dd>

  <dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>tolerance for convergence of power series if <code>power</code> is TRUE</p></dd>

  <dt id="arg-spchk">spChk<a class="anchor" aria-label="anchor" href="#arg-spchk"></a></dt>
<dd><p>should the row names of data frames be checked against the spatial objects for identity integrity, TRUE, or FALSE, default NULL to use <code><a href="https://r-spatial.github.io/spdep/reference/set.spChkOption.html" class="external-link">get.spChkOption()</a></code></p></dd>

  <dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>the object to be printed</p></dd>

</dl><p><!-- %   \item{pred.se}{logical, default FALSE, not available for error models} -->
<!-- %   \item{lagImpact}{object created by \code{impacts} with R sample draws from the fitted model} --></p>
<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments passed through</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function supports three types of prediction.  In-sample prediction is the computation of predictors on the data used to fit the model (<code>newdata=NULL</code>).  Prevision, also called forecast, is the computation of some predictors (“trend”, in-sample “TC” and out-of-sample “TS”) on the same spatial units than the ones used to fit the model, but with different observations of the variables in the model (row names of <code>newdata</code> should have the same row names than the data frame used to fit the model).  And out-of-sample prediction is the computation of predictors on other spatial units than the ones used to fit the model (<code>newdata</code> has different row names).  For extensive definitions, see Goulard et al. (2017). <!-- % add that warning if out-of-sample with newdata containing one in-sample spatial unit --></p>
<p><code>pred.type</code> of predictors are available according to the model of <code>object</code> an to the type of prediction.  In the two following tables, “yes” means that the predictor can be used with the model, “no” means that <code>predict.Sarlm()</code> will stop with an error, and “yes*” means that the predictor is not designed for the specified model, but it can be used with <code>predict.Sarlm()</code>.  In the last case, be careful with the computation of a inappropriate predictor.</p>
<p><em>In-sample predictors by models</em></p>
<table class="table table"><tr><td>pred.type</td><td>sem (mixed)</td><td>lag (mixed)</td><td>sac (mixed)</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>“trend”</td><td>yes</td><td>yes</td><td>yes</td></tr><tr><td>“TS”</td><td>yes</td><td>yes</td><td>no</td></tr><tr><td>“TC”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“BP”</td><td>no</td><td>yes</td><td>yes*</td></tr></table><p>Note that only “trend” and “TC” are available for prevision.</p>
<p><em>Out-of-sample predictors by models</em></p>
<table class="table table"><tr><td>pred.type</td><td>sem (mixed)</td><td>lag (mixed)</td><td>sac (mixed)</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>“trend”</td><td>yes</td><td>yes</td><td>yes</td></tr><tr><td>“TS”</td><td>yes</td><td>yes</td><td>no</td></tr><tr><td>“TS1” or “KP4”</td><td>no</td><td>yes</td><td>yes</td></tr><tr><td>“TC”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“TC1” or “KP1”</td><td>yes</td><td>yes</td><td>yes</td></tr><tr><td>“BP”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“BP1”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“BPW”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“BPW1”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“BN”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“BPN1”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“KP2”</td><td>yes</td><td>yes</td><td>yes</td></tr><tr><td>“KP3”</td><td>yes</td><td>yes</td><td>yes</td></tr><tr><td>“KP5”</td><td>yes</td><td>no</td><td>yes*</td></tr></table><p>Values for <code>pred.type=</code> include “TS1”, “TC”, “TC1”, “BP”, “BP1”, “BPW”, “BPW1”, “BPN”, “BPN1”, following the notation in Goulard et al. (2017), and for <code>pred.type=</code> “KP1”, “KP2”, “KP3”, “KP4”, “KP5”, following the notation in Kelejian et al. (2007).  <code>pred.type="TS"</code> is described bellow and in Bivand (2002).</p>

<p>In the following, the trend is the non-spatial smooth, the signal is the
spatial smooth, and the noise is the residual.  The fit returned by <code>pred.type="TS"</code> is the
sum of the trend and the signal.</p>
<p>When <code>pred.type="TS"</code>, the function approaches prediction first by dividing invocations between
those with or without newdata.  When no newdata is present, the response
variable may be reconstructed as the sum of the trend, the signal, and the
noise (residuals).  Since the values of the response variable are known,
their spatial lags are used to calculate signal components (Cressie 1993, p. 564).  For the error
model, trend = \(X \beta\), and signal = \(\lambda W y -
\lambda W X \beta\). For the lag and mixed
models, trend = \(X \beta\), and signal = \(\rho W y\).</p>
<p>This approach differs from the design choices made in other software, for
example GeoDa, which does not use observations of the response variable,
and corresponds to the newdata situation described below.</p>
<p>When however newdata is used for prediction, no observations of the response
variable being predicted are available.  Consequently, while the trend
components are the same, the signal cannot take full account of the spatial
smooth.  In the error model and Durbin error model, the signal is set to zero, since the spatial smooth is expressed in terms of the error:
\((I - \lambda W)^{-1} \varepsilon\).</p>
<p>In the lag model, the signal can be expressed in the following way (for legacy=TRUE):</p>
<p>$$(I - \rho W) y = X \beta + \varepsilon$$
$$y = (I - \rho W)^{-1} X \beta + (I - \rho W)^{-1} \varepsilon$$</p>
<p>giving a feasible signal component of:</p>
<p>$$\rho W y = \rho W (I - \rho W)^{-1} X \beta$$</p>
<p>For legacy=FALSE, the trend is computed first as:</p>
<p>$$X \beta$$</p>
<p>next the prediction using the DGP:</p>
<p>$$(I - \rho W)^{-1} X \beta$$</p>
<p>and the signal is found as the difference between prediction and trend. The numerical results for the legacy and DGP methods are identical.</p>
<p><!-- %TODO: words missing? -->
setting the error term to zero.  This also means that predictions of the
signal component for lag and mixed models require the inversion of an
n-by-n matrix.</p>
<p>Because the outcomes of the spatial smooth on the error term are
unobservable, this means that the signal values for newdata are
incomplete.  In the mixed model, the spatially lagged RHS variables
influence both the trend and the signal, so that the root mean square
prediction error in the examples below for this case with newdata is
smallest, although the model was not the best fit.</p>
<p>If <code>newdata</code> has more than one row, leave-one-out predictors (<code>pred.type=</code> include “TS1”, “TC1”, “BP1”, “BPW1”, “BPN1”, “KP1”, “KP2”, “KP3”, “KP4”, “KP5”) are computed separatly on each out-of-sample unit.</p>
<p><code>listw</code> should be provided except if <code>newdata=NULL</code> and <code>pred.type=</code> include “TS”, “trend”, or if <code>newdata</code> is not <code>NULL</code>, <code>pred.type="trend"</code> and <code>object</code> is not a mixed model.  <!-- % TODO: describe listw --></p>
<p><code>all.data</code> is useful when some out-of-sample predictors return different predictions for in-sample units, than the same predictor type computed only on in-sample data.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>predict.Sarlm()</code> returns a vector of predictions with three attribute
vectors of trend, signal (only for <code>pred.type="TS"</code>) and region.id values and two other attributes
of pred.type and call with class <code>Sarlm.pred</code>.</p>
<p><code>print.Sarlm.pred()</code> is a print function for this class, printing and
returning a data frame with columns: "fit", "trend" and "signal" (when available) and with region.id as row names.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Haining, R. 1990 <em>Spatial data analysis in the social and environmental sciences</em>, Cambridge: Cambridge University Press, p. 258; Cressie, N. A. C. 1993 <em>Statistics for spatial data</em>, Wiley, New York; Michel Goulard, Thibault Laurent &amp; Christine Thomas-Agnan, 2017 <em>About predictions in spatial autoregressive models: optimal and almost optimal strategies</em>,  Spatial Economic Analysis Volume 12, Issue 2–3, 304–325 <a href="https://doi.org/10.1080/17421772.2017.1300679" class="external-link">doi:10.1080/17421772.2017.1300679</a>
, ; Kelejian, H. H. and Prucha, I. R. 2007 <em>The relative efficiencies of various predictors in spatial econometric models containing spatial lags</em>, Regional Science and Urban Economics, Volume 37, Issue 3, 363–374; Bivand, R. 2002 <em>Spatial econometrics functions in R: Classes and methods</em>, Journal of Geographical Systems, Volume 4, No. 4, 405–421</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a> and Martin Gubri</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ML_models.html">errorsarlm</a></code>, <code><a href="ML_models.html">lagsarlm</a></code>, <code><a href="ML_models.html">sacsarlm</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">oldcol</span>, package<span class="op">=</span><span class="st">"spdep"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eig</span> <span class="op">&lt;-</span> <span class="fu"><a href="ML_models.html">lagsarlm</a></span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, <span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">COL.mix.eig</span> <span class="op">&lt;-</span> <span class="fu"><a href="ML_models.html">lagsarlm</a></span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, <span class="va">lw</span>,</span></span>
<span class="r-in"><span>  type<span class="op">=</span><span class="st">"mixed"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.mix.eig</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This method assumes the response is known - see manual page</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            fit      trend    signal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1001 26.044311 14.8543508 11.189960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1002 44.034234 29.2632112 14.771023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1003 43.511934 25.8193818 17.692553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1004 37.656561 16.4555583 21.201002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1005 10.902976  0.3664066 10.536570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1006 36.829798 24.2905246 12.539274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1007 44.290467 27.0386615 17.251806</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1008 38.853571 21.5342393 17.319331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1009 50.870854 29.5092783 21.361576</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1010 16.401300  5.6029104 10.798389</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1011 36.354390 28.6415353  7.712855</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1012 20.452836 12.4607277  7.992108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1013 20.324088 14.4173433  5.906745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1014 19.243496 10.2606419  8.982854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1015 19.747775 12.2556861  7.492089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1016  6.962527 -2.0137491  8.976276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1017  7.452143 -6.3808928 13.833036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1018 28.481587 14.2125594 14.269028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1019 43.351392 28.0442064 15.307186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1020 50.359682 30.6608153 19.698867</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1021 38.905226 24.7490977 14.156128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1022 44.724478 28.8314299 15.893048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1023 37.888974 23.7778863 14.111087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1024 45.527017 26.9163190 18.610698</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1025 32.429571 17.1892401 15.240331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1026 26.490842 14.8893980 11.601444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1027 35.629158 23.4577209 12.171437</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1028 35.574326 21.9001006 13.674226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1029 38.598639 23.1818442 15.416795</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1030 36.602053 14.8614072 21.740646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1031 50.320031 30.1013982 20.218633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1032 53.698863 31.2094168 22.489447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1033 49.364208 26.5151201 22.849088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1034 46.262357 25.5538226 20.708534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1035 39.177121 15.7689329 23.408188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1036 54.984344 32.6590841 22.325260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1037 51.611458 33.1290203 18.482438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1038 51.998831 30.7428313 21.256000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1039 43.651605 27.4107880 16.240817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1040 44.196841 25.9409252 18.255916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1041 49.310592 29.5106497 19.799943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1042 37.995310 15.7039024 22.291408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1043 46.908709 28.2687603 18.639948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1044 28.976789 19.5389223  9.437867</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1045 25.343793 17.1838200  8.159973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1046 24.006252 16.0103703  7.995882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1047 25.034907 18.4616473  6.573260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1048 10.478529  3.3573578  7.121171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1049 13.495623  5.3356502  8.159973</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.mix.eig</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span>,</span></span>
<span class="r-in"><span> legacy.mixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            fit      trend    signal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1001 29.038788 14.8543508 14.184437</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1002 46.227075 29.2632112 16.963864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1003 45.640479 25.8193818 19.821097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1004 36.643520 16.4555583 20.187962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1005 14.819940  0.3664066 14.453533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1006 38.764777 24.2905246 14.474252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1007 45.715716 27.0386615 18.677055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1008 37.514611 21.5342393 15.980372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1009 49.324228 29.5092783 19.814950</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1010 17.510607  5.6029104 11.907696</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1011 34.973608 28.6415353  6.332072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1012 21.079100 12.4607277  8.618372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1013 19.704134 14.4173433  5.286791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1014 16.365521 10.2606419  6.104879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1015 17.063856 12.2556861  4.808170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1016  6.190282 -2.0137491  8.204031</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1017  5.967260 -6.3808928 12.348153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1018 29.250462 14.2125594 15.037902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1019 41.530036 28.0442064 13.485830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1020 49.344770 30.6608153 18.683954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1021 39.508818 24.7490977 14.759720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1022 42.772692 28.8314299 13.941262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1023 37.114901 23.7778863 13.337015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1024 43.622499 26.9163190 16.706180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1025 33.247197 17.1892401 16.057957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1026 30.301331 14.8893980 15.411933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1027 38.316063 23.4577209 14.858342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1028 36.886068 21.9001006 14.985967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1029 38.970564 23.1818442 15.788720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1030 33.014615 14.8614072 18.153208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1031 48.209875 30.1013982 18.108477</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1032 50.808064 31.2094168 19.598647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1033 44.555996 26.5151201 18.040876</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1034 43.232773 25.5538226 17.678951</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1035 35.009061 15.7689329 19.240128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1036 52.113364 32.6590841 19.454280</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1037 52.189015 33.1290203 19.059995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1038 51.631805 30.7428313 20.888973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1039 46.543565 27.4107880 19.132776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1040 45.036095 25.9409252 19.095170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1041 45.907835 29.5106497 16.397185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1042 35.337110 15.7039024 19.633208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1043 43.948398 28.2687603 15.679638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1044 32.091257 19.5389223 12.552334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1045 29.647005 17.1838200 12.463185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1046 26.375304 16.0103703 10.364934</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1047 27.235807 18.4616473  8.774160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1048 14.785518  3.3573578 11.428160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1049 17.798835  5.3356502 12.463185</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">COL.mix.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 376.787</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">COL.mix.eig</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.580773</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.580773</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10.35029</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">COL.err.eig</span> <span class="op">&lt;-</span> <span class="fu"><a href="ML_models.html">errorsarlm</a></span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, <span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">COL.err.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 376.7609</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">COL.err.eig</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.776221</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.err.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This method assumes the response is known - see manual page</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.776221</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.err.eig</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span>  listw<span class="op">=</span><span class="va">lw</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 11.61744</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">COL.SDerr.eig</span> <span class="op">&lt;-</span> <span class="fu"><a href="ML_models.html">errorsarlm</a></span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, <span class="va">lw</span>,</span></span>
<span class="r-in"><span> etype<span class="op">=</span><span class="st">"emixed"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">COL.SDerr.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 377.1693</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">COL.SDerr.eig</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.619298</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.SDerr.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This method assumes the response is known - see manual page</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.619298</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.SDerr.eig</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span>  listw<span class="op">=</span><span class="va">lw</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only legacy.mixed=TRUE is supported for pred.type='TS' and mixed models. legacy.mixed is forced</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10.40472</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">COL.lag.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 374.7809</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">COL.lag.eig</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.772129</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.lag.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This method assumes the response is known - see manual page</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.772129</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.lag.eig</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span>  listw<span class="op">=</span><span class="va">lw</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10.72654</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.mix.eig</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span>,</span></span>
<span class="r-in"><span> legacy<span class="op">=</span><span class="cn">FALSE</span>, legacy.mixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">p2</span>, <span class="va">p3</span>, check.attributes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.mix.eig</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span>,</span></span>
<span class="r-in"><span> legacy<span class="op">=</span><span class="cn">FALSE</span>, power<span class="op">=</span><span class="cn">TRUE</span>, legacy.mixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">p2</span>, <span class="va">p4</span>, check.attributes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.mix.eig</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span>,</span></span>
<span class="r-in"><span> legacy<span class="op">=</span><span class="cn">TRUE</span>, power<span class="op">=</span><span class="cn">TRUE</span>, legacy.mixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">p2</span>, <span class="va">p5</span>, check.attributes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Roger Bivand, Gianfranco Piras.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

