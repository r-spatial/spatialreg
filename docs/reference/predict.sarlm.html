<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Prediction for spatial simultaneous autoregressive linear
model objects — predict.Sarlm • spatialreg</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Prediction for spatial simultaneous autoregressive linear
model objects — predict.Sarlm"><meta property="og:description" content="predict.Sarlm() calculates predictions as far as is at present possible for for spatial simultaneous autoregressive linear
model objects, using Haining's terminology for decomposition into
trend, signal, and noise, or other types of predictors --- see references."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spatialreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/SpatialFiltering.html">Moran Eigenvectors</a>
    </li>
    <li>
      <a href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a>
    </li>
    <li>
      <a href="../articles/sids_models.html">North Carolina SIDS data set (models)</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/r-spatial/spatialreg/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prediction for spatial simultaneous autoregressive linear
model objects</h1>
    
    <div class="hidden name"><code>predict.sarlm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>predict.Sarlm()</code> calculates predictions as far as is at present possible for for spatial simultaneous autoregressive linear
model objects, using Haining's terminology for decomposition into
trend, signal, and noise, or other types of predictors --- see references.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for Sarlm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, newdata <span class="op">=</span> <span class="cn">NULL</span>, listw <span class="op">=</span> <span class="cn">NULL</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span>, all.data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span> zero.policy <span class="op">=</span> <span class="cn">NULL</span>, legacy <span class="op">=</span> <span class="cn">TRUE</span>, legacy.mixed <span class="op">=</span> <span class="cn">FALSE</span>, power <span class="op">=</span> <span class="cn">NULL</span>, order <span class="op">=</span> <span class="fl">250</span>,</span>
<span> tol <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="op">(</span><span class="fl">3</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span>, spChk <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co">#\method{predict}{SLX}(object, newdata, listw, zero.policy=NULL, ...)</span></span>
<span><span class="co"># S3 method for Sarlm.pred</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for Sarlm.pred</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p><code>Sarlm</code> object returned by <code>lagsarlm</code>, 
<code>errorsarlm</code> or <code>sacsarlm</code>, the method for SLX objects takes the output of <code>lmSLX</code></p></dd>

  <dt>newdata</dt>
<dd><p>data frame in which to predict --- if NULL, predictions are
for the data on which the model was fitted. Should have row names corresponding to region.id. If row names are exactly the same than the ones used for training, it uses in-sample predictors for forecast.  See ‘Details’</p></dd>

  <dt>listw</dt>
<dd><p>a <code>listw</code> object created for example by <code>nb2listw</code>. In the out-of-sample prediction case (ie. if newdata is not NULL), if <code>legacy.mixed=FALSE</code> or if <code>pred.type!="TS"</code>, it should include both in-sample and out-of-sample spatial units. In this case, if regions of the listw are not in the correct order, they are reordered.  See ‘Details’</p></dd>

  <dt>pred.type</dt>
<dd><p>predictor type --- default “TS”, use decomposition into  
trend, signal, and noise ; other types available depending on <code>newdata</code>. If <code>newdata=NULL</code> (in-sample prediction), “TS”, “trend”, “TC” and “BP” are available. If <code>newdata</code> is not NULL and its row names are the same than the <code>data</code> used to fit the model (forecast case), “TS”, “trend” and “TC” are available. In other cases (out-of-sample prediction), “TS”, “trend”, “KP1”, “KP2”, “KP3”, “KP4”, “KP5”, “TC”, “BP”, “BPW”, “BPN”, “TS1”, “TC1”, “BP1”, “BPW1” and “BPN1” are available.  See ‘Details’ and references</p></dd>

  <dt>all.data</dt>
<dd><p>(only applies to <code>pred.type="TC"</code> and newdata is not NULL) default FALSE: return predictions only for newdata units, if TRUE return predictions for all data units.  See ‘Details’</p></dd>

  <dt>zero.policy</dt>
<dd><p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without 
neighbours, if FALSE (default) assign NA - causing the function to 
terminate with an error</p></dd>

  <dt>legacy</dt>
<dd><p>(only applies to lag and Durbin (mixed) models for <code>pred.type="TS"</code>) default TRUE: use ad-hoc predictor, if FALSE use DGP-based predictor</p></dd>

  <dt>legacy.mixed</dt>
<dd><p>(only applies to mixed models if newdata is not NULL) default FALSE: compute lagged variables from both in-sample and out-of-sample units with \([W X]_O\) and \([W X]_S\) where <code>X=cbind(Xs, Xo)</code>, if TRUE compute lagged variables independantly between in-sample and out-of-sample units with \(W_{OO} X_O\) and \(W_{SS} X_S\)</p></dd>

  <dt>power</dt>
<dd><p>(only applies to lag and Durbin (mixed) models for “TS”, “KP1”, “KP2”, “KP3”, “TC”, “TC1”, “BP”, “BP1”, “BPN”, “BPN1”, “BPW” and “BPW1” types) use <code>powerWeights</code>, if default NULL, set FALSE if <code>object$method</code> is “eigen”, otherwise TRUE</p></dd>

  <dt>order</dt>
<dd><p>power series maximum limit if <code>power</code> is TRUE</p></dd>

  <dt>tol</dt>
<dd><p>tolerance for convergence of power series if <code>power</code> is TRUE</p></dd>

  <dt>spChk</dt>
<dd><p>should the row names of data frames be checked against the spatial objects for identity integrity, TRUE, or FALSE, default NULL to use <code><a href="https://r-spatial.github.io/spdep/reference/set.spChkOption.html" class="external-link">get.spChkOption()</a></code></p></dd>

  <dt>x</dt>
<dd><p>the object to be printed</p></dd>

</dl><p><!-- %   \item{pred.se}{logical, default FALSE, not available for error models} --></p>


<p><!-- %   \item{lagImpact}{object created by \code{impacts} with R sample draws from the fitted model} --></p>
<dl><dt>...</dt>
<dd><p>further arguments passed through</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function supports three types of prediction.  In-sample prediction is the computation of predictors on the data used to fit the model (<code>newdata=NULL</code>).  Prevision, also called forecast, is the computation of some predictors (“trend”, in-sample “TC” and out-of-sample “TS”) on the same spatial units than the ones used to fit the model, but with different observations of the variables in the model (row names of <code>newdata</code> should have the same row names than the data frame used to fit the model).  And out-of-sample prediction is the computation of predictors on other spatial units than the ones used to fit the model (<code>newdata</code> has different row names).  For extensive definitions, see Goulard et al. (2017). <!-- % add that warning if out-of-sample with newdata containing one in-sample spatial unit --></p>
<p><code>pred.type</code> of predictors are available according to the model of <code>object</code> an to the type of prediction.  In the two following tables, “yes” means that the predictor can be used with the model, “no” means that <code>predict.Sarlm()</code> will stop with an error, and “yes*” means that the predictor is not designed for the specified model, but it can be used with <code>predict.Sarlm()</code>.  In the last case, be careful with the computation of a inappropriate predictor.</p>
<p><em>In-sample predictors by models</em></p>
<table class="table table"><tr><td>pred.type</td><td>sem (mixed)</td><td>lag (mixed)</td><td>sac (mixed)</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>“trend”</td><td>yes</td><td>yes</td><td>yes</td></tr><tr><td>“TS”</td><td>yes</td><td>yes</td><td>no</td></tr><tr><td>“TC”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“BP”</td><td>no</td><td>yes</td><td>yes*</td></tr></table><p>Note that only “trend” and “TC” are available for prevision.</p>
<p><em>Out-of-sample predictors by models</em></p>
<table class="table table"><tr><td>pred.type</td><td>sem (mixed)</td><td>lag (mixed)</td><td>sac (mixed)</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>“trend”</td><td>yes</td><td>yes</td><td>yes</td></tr><tr><td>“TS”</td><td>yes</td><td>yes</td><td>no</td></tr><tr><td>“TS1” or “KP4”</td><td>no</td><td>yes</td><td>yes</td></tr><tr><td>“TC”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“TC1” or “KP1”</td><td>yes</td><td>yes</td><td>yes</td></tr><tr><td>“BP”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“BP1”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“BPW”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“BPW1”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“BN”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“BPN1”</td><td>no</td><td>yes</td><td>yes*</td></tr><tr><td>“KP2”</td><td>yes</td><td>yes</td><td>yes</td></tr><tr><td>“KP3”</td><td>yes</td><td>yes</td><td>yes</td></tr><tr><td>“KP5”</td><td>yes</td><td>no</td><td>yes*</td></tr></table><p>Values for <code>pred.type=</code> include “TS1”, “TC”, “TC1”, “BP”, “BP1”, “BPW”, “BPW1”, “BPN”, “BPN1”, following the notation in Goulard et al. (2017), and for <code>pred.type=</code> “KP1”, “KP2”, “KP3”, “KP4”, “KP5”, following the notation in Kelejian et al. (2007).  <code>pred.type="TS"</code> is described bellow and in Bivand (2002).</p>

<p>In the following, the trend is the non-spatial smooth, the signal is the
spatial smooth, and the noise is the residual.  The fit returned by <code>pred.type="TS"</code> is the
sum of the trend and the signal.</p>
<p>When <code>pred.type="TS"</code>, the function approaches prediction first by dividing invocations between 
those with or without newdata.  When no newdata is present, the response 
variable may be reconstructed as the sum of the trend, the signal, and the
noise (residuals).  Since the values of the response variable are known,
their spatial lags are used to calculate signal components (Cressie 1993, p. 564).  For the error
model, trend = \(X \beta\), and signal = \(\lambda W y - 
\lambda W X \beta\). For the lag and mixed
models, trend = \(X \beta\), and signal = \(\rho W y\).</p>
<p>This approach differs from the design choices made in other software, for
example GeoDa, which does not use observations of the response variable,
and corresponds to the newdata situation described below.</p>
<p>When however newdata is used for prediction, no observations of the response 
variable being predicted are available.  Consequently, while the trend
components are the same, the signal cannot take full account of the spatial
smooth.  In the error model and Durbin error model, the signal is set to zero, since the spatial smooth is expressed in terms of the error: 
\((I - \lambda W)^{-1} \varepsilon\).</p>
<p>In the lag model, the signal can be expressed in the following way (for legacy=TRUE):</p>
<p>$$(I - \rho W) y = X \beta + \varepsilon$$
$$y = (I - \rho W)^{-1} X \beta + (I - \rho W)^{-1} \varepsilon$$</p>
<p>giving a feasible signal component of:</p>
<p>$$\rho W y = \rho W (I - \rho W)^{-1} X \beta$$</p>
<p>For legacy=FALSE, the trend is computed first as:</p>
<p>$$X \beta$$</p>
<p>next the prediction using the DGP:</p>
<p>$$(I - \rho W)^{-1} X \beta$$</p>
<p>and the signal is found as the difference between prediction and trend. The numerical results for the legacy and DGP methods are identical.</p>
<p><!-- %TODO: words missing? -->
setting the error term to zero.  This also means that predictions of the
signal component for lag and mixed models require the inversion of an 
n-by-n matrix.</p>
<p>Because the outcomes of the spatial smooth on the error term are
unobservable, this means that the signal values for newdata are
incomplete.  In the mixed model, the spatially lagged RHS variables
influence both the trend and the signal, so that the root mean square
prediction error in the examples below for this case with newdata is
smallest, although the model was not the best fit.</p>
<p>If <code>newdata</code> has more than one row, leave-one-out predictors (<code>pred.type=</code> include “TS1”, “TC1”, “BP1”, “BPW1”, “BPN1”, “KP1”, “KP2”, “KP3”, “KP4”, “KP5”) are computed separatly on each out-of-sample unit.</p>
<p><code>listw</code> should be provided except if <code>newdata=NULL</code> and <code>pred.type=</code> include “TS”, “trend”, or if <code>newdata</code> is not <code>NULL</code>, <code>pred.type="trend"</code> and <code>object</code> is not a mixed model.  <!-- % TODO: describe listw --></p>
<p><code>all.data</code> is useful when some out-of-sample predictors return different predictions for in-sample units, than the same predictor type computed only on in-sample data.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p></p>
<p><code>predict.Sarlm()</code> returns a vector of predictions with three attribute 
vectors of trend, signal (only for <code>pred.type="TS"</code>) and region.id values and two other attributes
of pred.type and call with class <code>Sarlm.pred</code>.</p>
<p></p>
<p><code>print.Sarlm.pred()</code> is a print function for this class, printing and
returning a data frame with columns: "fit", "trend" and "signal" (when available) and with region.id as row names.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Haining, R. 1990 <em>Spatial data analysis in the social and environmental sciences</em>, Cambridge: Cambridge University Press, p. 258; Cressie, N. A. C. 1993 <em>Statistics for spatial data</em>, Wiley, New York; Michel Goulard, Thibault Laurent &amp; Christine Thomas-Agnan, 2017 <em>About predictions in spatial autoregressive models: optimal and almost optimal strategies</em>,  Spatial Economic Analysis Volume 12, Issue 2--3, 304--325 <a href="https://doi.org/10.1080/17421772.2017.1300679" class="external-link">doi:10.1080/17421772.2017.1300679</a>
, ; Kelejian, H. H. and Prucha, I. R. 2007 <em>The relative efficiencies of various predictors in spatial econometric models containing spatial lags</em>, Regional Science and Urban Economics, Volume 37, Issue 3, 363--374; Bivand, R. 2002 <em>Spatial econometrics functions in R: Classes and methods</em>, Journal of Geographical Systems, Volume 4, No. 4, 405--421</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a> and Martin Gubri</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ML_models.html">errorsarlm</a></code>, <code><a href="ML_models.html">lagsarlm</a></code>, <code><a href="ML_models.html">sacsarlm</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">oldcol</span>, package<span class="op">=</span><span class="st">"spdep"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.lag.eig</span> <span class="op">&lt;-</span> <span class="fu"><a href="ML_models.html">lagsarlm</a></span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, <span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">COL.mix.eig</span> <span class="op">&lt;-</span> <span class="fu"><a href="ML_models.html">lagsarlm</a></span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, <span class="va">lw</span>,</span></span>
<span class="r-in"><span>  type<span class="op">=</span><span class="st">"mixed"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.mix.eig</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This method assumes the response is known - see manual page</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            fit     trend    signal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1001 26.044310 14.854350 11.189960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1002 44.034234 29.263210 14.771023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1003 43.511934 25.819381 17.692554</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1004 37.656561 16.455557 21.201004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1005 10.902976  0.366406 10.536570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1006 36.829798 24.290524 12.539274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1007 44.290467 27.038660 17.251807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1008 38.853571 21.534238 17.319332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1009 50.870854 29.509277 21.361577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1010 16.401300  5.602910 10.798390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1011 36.354390 28.641535  7.712855</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1012 20.452836 12.460727  7.992109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1013 20.324088 14.417343  5.906745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1014 19.243496 10.260642  8.982854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1015 19.747775 12.255686  7.492089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1016  6.962527 -2.013749  8.976277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1017  7.452143 -6.380893 13.833037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1018 28.481587 14.212559 14.269028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1019 43.351392 28.044206 15.307187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1020 50.359682 30.660814 19.698868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1021 38.905226 24.749097 14.156129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1022 44.724478 28.831429 15.893049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1023 37.888974 23.777886 14.111088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1024 45.527017 26.916318 18.610699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1025 32.429571 17.189239 15.240332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1026 26.490842 14.889397 11.601445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1027 35.629157 23.457720 12.171437</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1028 35.574326 21.900100 13.674226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1029 38.598639 23.181843 15.416796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1030 36.602053 14.861406 21.740647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1031 50.320031 30.101397 20.218634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1032 53.698863 31.209416 22.489448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1033 49.364208 26.515119 22.849089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1034 46.262357 25.553822 20.708535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1035 39.177121 15.768932 23.408190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1036 54.984344 32.659083 22.325261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1037 51.611458 33.129019 18.482439</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1038 51.998831 30.742830 21.256001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1039 43.651605 27.410787 16.240818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1040 44.196841 25.940924 18.255917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1041 49.310593 29.510649 19.799944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1042 37.995310 15.703901 22.291409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1043 46.908709 28.268759 18.639949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1044 28.976789 19.538922  9.437868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1045 25.343793 17.183819  8.159973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1046 24.006252 16.010370  7.995883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1047 25.034907 18.461647  6.573260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1048 10.478529  3.357357  7.121172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1049 13.495623  5.335650  8.159973</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.mix.eig</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span>,</span></span>
<span class="r-in"><span> legacy.mixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            fit     trend    signal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1001 29.038788 14.854350 14.184438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1002 46.227075 29.263210 16.963865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1003 45.640479 25.819381 19.821099</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1004 36.643520 16.455557 20.187963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1005 14.819940  0.366406 14.453534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1006 38.764777 24.290524 14.474253</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1007 45.715716 27.038660 18.677056</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1008 37.514611 21.534238 15.980372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1009 49.324228 29.509277 19.814951</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1010 17.510606  5.602910 11.907697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1011 34.973607 28.641535  6.332073</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1012 21.079100 12.460727  8.618373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1013 19.704134 14.417343  5.286791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1014 16.365521 10.260642  6.104879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1015 17.063856 12.255686  4.808170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1016  6.190282 -2.013749  8.204032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1017  5.967260 -6.380893 12.348154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1018 29.250462 14.212559 15.037903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1019 41.530036 28.044206 13.485830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1020 49.344769 30.660814 18.683955</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1021 39.508818 24.749097 14.759721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1022 42.772692 28.831429 13.941263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1023 37.114901 23.777886 13.337016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1024 43.622499 26.916318 16.706181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1025 33.247197 17.189239 16.057958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1026 30.301331 14.889397 15.411934</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1027 38.316063 23.457720 14.858343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1028 36.886068 21.900100 14.985968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1029 38.970564 23.181843 15.788721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1030 33.014615 14.861406 18.153209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1031 48.209875 30.101397 18.108478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1032 50.808064 31.209416 19.598648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1033 44.555996 26.515119 18.040877</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1034 43.232773 25.553822 17.678952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1035 35.009061 15.768932 19.240129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1036 52.113364 32.659083 19.454281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1037 52.189015 33.129019 19.059996</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1038 51.631805 30.742830 20.888974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1039 46.543564 27.410787 19.132778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1040 45.036095 25.940924 19.095171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1041 45.907835 29.510649 16.397186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1042 35.337110 15.703901 19.633209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1043 43.948398 28.268759 15.679639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1044 32.091257 19.538922 12.552335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1045 29.647005 17.183819 12.463186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1046 26.375304 16.010370 10.364935</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1047 27.235807 18.461647  8.774160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1048 14.785518  3.357357 11.428161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1049 17.798836  5.335650 12.463186</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">COL.mix.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 376.787</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">COL.mix.eig</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.580773</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.580773</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10.35029</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">COL.err.eig</span> <span class="op">&lt;-</span> <span class="fu"><a href="ML_models.html">errorsarlm</a></span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, <span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">COL.err.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 376.7609</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">COL.err.eig</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.776221</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.err.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This method assumes the response is known - see manual page</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.776221</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.err.eig</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span>  listw<span class="op">=</span><span class="va">lw</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 11.61744</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">COL.SDerr.eig</span> <span class="op">&lt;-</span> <span class="fu"><a href="ML_models.html">errorsarlm</a></span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, <span class="va">lw</span>,</span></span>
<span class="r-in"><span> etype<span class="op">=</span><span class="st">"emixed"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">COL.SDerr.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 377.1693</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">COL.SDerr.eig</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.619298</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.SDerr.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This method assumes the response is known - see manual page</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.619298</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.SDerr.eig</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span>  listw<span class="op">=</span><span class="va">lw</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>only legacy.mixed=TRUE is supported for pred.type='TS' and mixed models. legacy.mixed is forced</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10.40472</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">COL.lag.eig</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 374.7809</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">COL.lag.eig</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.772129</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.lag.eig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This method assumes the response is known - see manual page</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.772129</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">CRIME</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.lag.eig</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>,</span></span>
<span class="r-in"><span>  listw<span class="op">=</span><span class="va">lw</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10.72654</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.mix.eig</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span>,</span></span>
<span class="r-in"><span> legacy<span class="op">=</span><span class="cn">FALSE</span>, legacy.mixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">p2</span>, <span class="va">p3</span>, check.attributes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.mix.eig</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span>,</span></span>
<span class="r-in"><span> legacy<span class="op">=</span><span class="cn">FALSE</span>, power<span class="op">=</span><span class="cn">TRUE</span>, legacy.mixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">p2</span>, <span class="va">p4</span>, check.attributes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.mix.eig</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span>, pred.type <span class="op">=</span> <span class="st">"TS"</span>,</span></span>
<span class="r-in"><span> legacy<span class="op">=</span><span class="cn">TRUE</span>, power<span class="op">=</span><span class="cn">TRUE</span>, legacy.mixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">p2</span>, <span class="va">p5</span>, check.attributes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Roger Bivand, Gianfranco Piras.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

